import L from"./MyIcon-DFp2dIsX.js";import{g as W,k as b,F as R,M as v,u as j,r as q,N as Q,o as P,w as U,c as T,d as X,a as i,O as Y,b as u,S as G,Q as k}from"./app-RDSFbjX4.js";import{_ as J}from"./plugin-vue_export-helper-DlAUqK2U.js";const K=W({__name:"PreviewImage",setup(O,{expose:p}){p();let d=b([]),t=b(!1),s=b(0);function C(){t.value=!1,document.body.style.overflow="auto"}function E(e){const n=document.getElementById("Mo7PreviewBox-img");if(!n)return;const o=n.getBoundingClientRect();e.clientX>=o.left&&e.clientX<=o.right&&e.clientY>=o.top&&e.clientY<=o.bottom||C()}function x(){const e=document.getElementById("Mo7PreviewBox-img");if(e){let n=e.clientWidth,o=e.clientHeight;n*=1.1,o*=1.1,e.style.width=`${n}px`,e.style.height=`${o}px`}}function I(){const e=document.getElementById("Mo7PreviewBox-img");if(e){let n=e.clientWidth,o=e.clientHeight;n*=.9,o*=.9,e.style.width=`${n}px`,e.style.height=`${o}px`}}function w(){const e=document.getElementById("Mo7PreviewBox-img");e&&window.open(e.src)}function y(){s.value>0&&s.value--,v(()=>{_()})}function V(){s.value<d.value.length-1&&s.value++,v(()=>{_()})}function _(){const e=document.getElementById("Mo7PreviewBox"),n=document.getElementById("Mo7PreviewBox-img");if(!e||!n)return;const o=e.clientWidth,c=e.clientHeight;n.style.width=`${o*.9}px`,n.style.height="",n.style.maxWidth="",n.style.maxHeight="",n.style.left="",n.style.top="",n.style.cursor="",n.clientHeight>c&&(n.style.width="",n.style.height=`${c*.9}px`)}function M(e){const o=e.target.getAttribute("src");if(!o)return;const c=d.value.findIndex(a=>a.src===o);c!==-1&&(s.value=c,t.value=!0,document.body.style.overflow="hidden",v(()=>{_()}))}function B(e){const n=document.getElementsByClassName("theme-hope-content"),o=n.length>0?n[0]:null;if(!o)return;const c=o.getElementsByTagName("img"),a=[];for(const l of c)e==="bind"&&a.push({alt:l.getAttribute("alt")||"",src:l.getAttribute("src")||""}),l.removeEventListener("click",M),e==="bind"&&l.addEventListener("click",M);d.value=a}let g=!1,r=0,m=0,f=0,h=0;function A(e){if(!g)return;const n=e instanceof MouseEvent?e.clientX-r:e.touches[0].clientX-r,o=e instanceof MouseEvent?e.clientY-m:e.touches[0].clientY-m,c=f+n,a=h+o,l=document.getElementById("Mo7PreviewBox-img");l&&(l.style.left=`${c}px`,l.style.top=`${a}px`)}function S(){const e=document.getElementById("Mo7PreviewBox-img");e&&(e.style.cursor="default"),g=!1,r=0,m=0,f=0,h=0}function F(e){const n=document.getElementById("Mo7PreviewBox-img");if(!n)return;n.style.cursor="move",g=!0,e instanceof MouseEvent?(r=e.clientX,m=e.clientY):(r=e.touches[0].clientX,m=e.touches[0].clientY);const o=window.getComputedStyle(n);f=parseInt(o.left,10)||0,h=parseInt(o.top,10)||0}function H(e){A(e)}function N(e){S()}function z(e){F(e)}R(()=>{v(()=>{B("bind")});const e=j();e.beforeEach((n,o)=>{n.path!==o.path&&B("unbind")}),e.afterEach((n,o)=>{n.path!==o.path&&v(()=>{setTimeout(()=>{B("bind")},1e3)})})});const D={get ImageArr(){return d},set ImageArr(e){d=e},get ShowPreviewBox(){return t},set ShowPreviewBox(e){t=e},get CurrentImgIdx(){return s},set CurrentImgIdx(e){s=e},ClosePreviewBox:C,closeOnOutsideClick:E,zoomFunc:x,shrinkFunc:I,fullscreenFunc:w,leftFunc:y,rightFunc:V,ImageBoxReset:_,ImageClick:M,InitPreviewImage:B,get mouseStatus(){return g},set mouseStatus(e){g=e},get mouseDownX(){return r},set mouseDownX(e){r=e},get mouseDownY(){return m},set mouseDownY(e){m=e},get imgElmLeft(){return f},set imgElmLeft(e){f=e},get imgElmTop(){return h},set imgElmTop(e){h=e},Mousemove:A,ImgMouseUp:S,ImgMouseDown:F,on_mousemove:H,on_mouseup:N,on_mousedown:z,MyIcon:L};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),Z={class:"Mo7PreviewBox-topBar"},$=["href"],ee=["src","alt"],te={class:"Mo7PreviewBox-idxView"},ne={class:"Mo7PreviewBox-idxView-box"},oe={class:"Mo7PreviewBox-idxView-idx"},ie={key:0,class:"Mo7PreviewBox-idxView-alt"};function ce(O,p,d,t,s,C){const E=q("ClientOnly");return P(),Q(E,null,{default:U(()=>{var x,I,w,y;return[t.ShowPreviewBox?(P(),T("div",{key:0,id:"Mo7PreviewBox",onMousemove:t.on_mousemove,onTouchmove:t.on_mousemove,onMouseup:t.on_mouseup,onTouchend:t.on_mouseup,onClick:t.closeOnOutsideClick},[i("div",Z,[i("div",{class:Y(["btn",{hide:t.CurrentImgIdx===0}]),onClick:t.leftFunc},[u(t.MyIcon,{class:"icon",name:"xiangzuo"})],2),i("div",{class:Y(["btn",{hide:t.CurrentImgIdx===t.ImageArr.length-1}]),onClick:t.rightFunc},[u(t.MyIcon,{class:"icon",name:"xiangyou"})],2),i("div",{class:"btn",onClick:t.zoomFunc},[u(t.MyIcon,{class:"icon",name:"fangda"})]),i("div",{class:"btn",onClick:t.shrinkFunc},[u(t.MyIcon,{class:"icon",name:"suoxiao"})]),i("div",{class:"btn",onClick:t.fullscreenFunc},[u(t.MyIcon,{class:"icon",name:"quanping"})]),i("a",{class:"btn",href:t.ImageArr[t.CurrentImgIdx].src,download:""},[u(t.MyIcon,{class:"icon",name:"xiazai"})],8,$),i("div",{class:"btn",onClick:t.ClosePreviewBox},[u(t.MyIcon,{class:"icon",name:"guanbi"})])]),i("img",{id:"Mo7PreviewBox-img",onMousedown:t.on_mousedown,onTouchstart:t.on_mousedown,onClick:G(()=>{},["stop"]),src:(x=t.ImageArr[t.CurrentImgIdx])==null?void 0:x.src,alt:(I=t.ImageArr[t.CurrentImgIdx])==null?void 0:I.alt},null,40,ee),i("div",te,[i("div",ne,[i("div",oe,k(t.CurrentImgIdx+1)+"/"+k(t.ImageArr.length),1),(w=t.ImageArr[t.CurrentImgIdx])!=null&&w.alt?(P(),T("div",ie,k((y=t.ImageArr[t.CurrentImgIdx])==null?void 0:y.alt),1)):X("v-if",!0)])])],32)):X("v-if",!0)]}),_:1})}const me=J(K,[["render",ce],["__file","PreviewImage.vue"]]);export{me as default};
