<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xsl" href="https://blog.ysf.cc/atom.xsl"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-CN">
  <id>https://blog.ysf.cc/</id>
  <title>LeafinWind</title>
  <subtitle>叶随风2 - 简单快乐1，理应如此。</subtitle>
  <icon>https://blog.ysf.cc/pwa/huge.png</icon>
  <logo>https://blog.ysf.cc/pwa/huge.png</logo>
  <updated>2025-09-29T02:31:03.863Z</updated>
  <generator>@vuepress/plugin-feed</generator>
  <link rel="self" href="https://blog.ysf.cc/atom.xml"/>
  <link rel="alternate" href="https://blog.ysf.cc/"/>
  <category term="SAP"/>
  <category term="随笔"/>
  <category term="博客"/>
  <entry>
    <title type="text">网页转pdf</title>
    <id>https://blog.ysf.cc/developer/golang/htmltopdf.html</id>
    <link href="https://blog.ysf.cc/developer/golang/htmltopdf.html"/>
    <updated>2025-09-29T02:29:48.000Z</updated>
    <summary type="text">网页转pdf
文章以Markdown格式存储，并通过GitSite工具生成HTML静态页面。现在，要把一个页面转成一个PDF文件，最简单的方法是用浏览器的打印功能，可以直接将页面输出为PDF。
这个可以使本博客的文章变成PDF。
思路与代码



参考文献
网页转PDF技术指南-廖雪峰
下载main.go文档</summary>
    <content type="html"><![CDATA[<!-- more -->
<h1>网页转pdf</h1>
<p>文章以Markdown格式存储，并通过GitSite工具生成HTML静态页面。现在，要把一个页面转成一个PDF文件，最简单的方法是用浏览器的打印功能，可以直接将页面输出为PDF。</p>
<p>这个可以使本博客的文章变成PDF。</p>
<h3>思路与代码</h3>
<p>| # | 流程 | 说明 |<br>
|</p>
]]></content>
    <published>2025-09-23T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">科目确定</title>
    <id>https://blog.ysf.cc/sap/fico/accountdetermination.html</id>
    <link href="https://blog.ysf.cc/sap/fico/accountdetermination.html"/>
    <updated>2025-09-12T03:15:08.000Z</updated>
    <summary type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
<!-- more -->
<p>T030A 业务代码和分配到集团</p>
<h2>1. FI / MM 模块</h2>
<p>事务码：OBYC<br>
| Transaction Key     | 业务场景               | 典型科目示例                |<br>
|</p>
]]></content>
    <category term="SAP"/>
    <published>2025-07-04T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">SAP-&amp;gt;外围系统调用外部RESTful接口</title>
    <id>https://blog.ysf.cc/sap/abap/porestful.html</id>
    <link href="https://blog.ysf.cc/sap/abap/porestful.html"/>
    <updated>2025-09-29T02:29:48.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<ul>
<li>进入 PO 集成引擎的消息必须是 XML（这是 PI/PO 内部统一的消息格式）。</li>
<li>但“外围系统→PO”这一段可以发 JSON、CSV、EDI、纯文本等，只要在 Sender 通道里选对适配器并开好 Content Conversion/JSON-to-XML 转换；PO 会在通道级别先转成 XML，再往后走。</li>
<li>因此：SAP 端通过 PO 接收到的永远是 XML，而外围系统不一定非得发 XML。<br>
事物代码  SXI_MONITOR  XI:消息监控</li>
</ul>
<h2>1.名词解释</h2>
<p>Message Mapping-消息映射(简写MM)<br>
Service Interfaces-服务接口(简写SI)<br>
Operation Mapping-操作映射(简写OM)<br>
External Definition-外部定义(简写ED)<br>
DaTa Types-数据类型(简写DT)<br>
Message Type-消息类型(简写MT)</p>
<p>Integrated Configuration-集成配置(简写IC)<br>
Communication Channel-通信通道(简写CC)<br>
Adapter Type-适配器类型(简写AT)<br>
Business System-业务系统(简写BS)<br>
Business ComPonent-业务组件(简写BC)</p>
<p>Enterprise Services Repository-企业服务仓库(简写ESR)<br>
Integration Directory-集成目录(简写ID)</p>
<h2>2.通信概览图</h2>
<p><strong>个人整理所得，可能有误，欢迎指正</strong><br>
</p>
<p>一开始先用POSTMAN或者SOAPUI调用看看对方提供的接口是否能正常调通</p>
<h2>3.PO端接口配置步骤</h2>
<p><br>
PO端配置完全后，去SAP SPROXY生成SI_SAP_OUT的代理，代码编写进行调用</p>
<h3>3.1 ESR-在软件组件下创建命名空间</h3>
<p><br>
</p>
<h3>3.2 ESR-在命名空间下创建接口对象-数据类型DT</h3>
<p><br>
</p>
<h3>3.3 ESR-在命名空间下创建接口对象-消息类型MT</h3>
<p>引用参考上面建的数据类型DT<br>
如果有WSDL文件，可以直接导入成外部定义ED类似这里的MT<br>
<br>
</p>
<h3>3.4 ESR-创建接口对象-服务接口SI</h3>
<p><br>
</p>
<h3>3.5 ESR-创建映射对象-消息映射MM</h3>
<p><br>
引用参考上面建的消息类型MT，创建两边对应的映射关系<br>
如果没有特殊的映射关系，直接一一对应两边拉一下<br>
</p>
<h3>3.6 ESR-创建映射对象-操作映射OM</h3>
<p><br>
四个地方，SI_OUT，SI_IN，MM_REQ，MM_RES。</p>
<h3>3.7 ID-创建通信通道CC-业务系统BS</h3>
<p>在对应的CC下面创建，比如我这里的SAP-S4DCLNT300<br>
</p>
<h3>3.8 ID-创建通信通道CC-业务组件BC</h3>
<p>在对应的CC下面创建，比如我这里的外围系统-BC_SRM<br>
<br>
适配器类型选择REST，选择Receiver<br>
<br>
在REST URL页签填写对应对方系统提供的接口地址<br>
<br>
在REST Operation页签填写对应对方系统提供的接口操作HTTP动词<br>
<br>
在DATA Format数据格式页签填写对应的传出传入数据格式和Custom XML/JSON Conversion Rules自定义数据转换格式<br>
传出XML-&gt;JSON（传出格式）<br>
<br>
传入JSON（传入格式）-&gt;XML<br>
<br>
自定义数据格式，这三个参数是数组<br>
</p>
<h3>3.9 ID-创建集成配置IC</h3>
<p><br>
<br>
<br>
<br>
</p>
<h3>3.10 SAP-PROXY创建对应代理，测试</h3>
<p>创建并激活<br>
<br>
测试<br>
<br>
<br>
替换成对方提供的测试传入报文<br>
<br>
</p>
<p>成功完结撒花☺️<br>
后面用的话就是调用这个代理类ZCO_SI_SAP_RETURN_OUT</p>
]]></content>
    <category term="SAP"/>
    <published>2025-09-09T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">Controlling-Cost Center Accounting    控制-成本中心会计</title>
    <id>https://blog.ysf.cc/sap/fico/co-cca.html</id>
    <link href="https://blog.ysf.cc/sap/fico/co-cca.html"/>
    <updated>2025-09-12T03:15:08.000Z</updated>
    <summary type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
<!-- more -->
<h2>1. 成本中心</h2>
<p>成本中心是企业用来核算费用的最小组织单元，相当于企业的部门，如财务部、装配车间等。<br>
成本中心是对成本中心的费用进行计划、记账、拆分(分配或分摊)及分析。<br>
成本中心会计模块的基本功能包括:主数据维护、成本中心计划、成本中心实际过账、月末操作等。</p>
<p>分配 根据统计关键指数里和分配的段里的接收方的一致，按统计比例分配发送方的费用。</p>
<p>辅助生产部门的所有费用通过分配转到到生产部门成本中心(制造工程部-&gt;一厂   之后是后续领料投料啥的产生的   -&gt;一厂产线-&gt;工单-&gt;销售成本/收入)<br>
管理部门费用直接计入管理费用</p>
<p><br>
</p>
<h2>损益类科目：</h2>
<p>损益类科目（如收入、费用、成本等）主要用于记录企业在一定时期内的经营成果，即收入和费用的增减变动。<br>
这些科目的余额在会计期末会结转到利润表（损益类报表）中，用于计算企业的净利润。<br>
损益类报表（利润表）：是企业财务报表的重要组成部分，反映了企业在一定时期内的经营成果。它通过汇总损益类科目的数据，展示企业的收入、费用和利润情况。</p>
<h3>成本要素类别</h3>
<p>如果损益类科目有成本要素类别，那么它通常会与成本中心或利润中心有关，用于成本核算和利润分析。这些科目可以通过成本要素在成本中心或利润中心中进行核算和管理。<br>
例如：<br>
管理费用（初级成本要素）：可能分配到管理成本中心。<br>
销售收入（次级成本要素）：可能分配到销售利润中心。<br>
损益类科目与损益类报表：<br>
所有损益类科目（无论是否与成本中心或利润中心关联）最终都会进入损益类报表（利润表）。<br>
损益类报表通过汇总这些科目的数据，计算企业的净利润。</p>
<h2>初级成本要素与次级成本要素</h2>
<p>成本要素反应成本的属性(差旅费、办公费、还是某部门费用的分摊等)<br>
初级成本要素：<br>
直接从FI模块过账到CO模块。<br>
与总账科目直接关联，余额直接反映在总账中。<br>
用于记录实际发生的费用，归集到成本中心。<br>
01：费用类初级成本要素（用于记录费用）<br>
11：收入类初级成本要素（用于记录收入）<br>
22：外部结算类初级成本要素（用于跨模块结算）</p>
<p>次级成本要素：<br>
在CO模块内部使用，用于费用分配、分摊或结算。<br>
不直接与总账科目关联，余额不会直接进入总账。<br>
用于在成本中心或利润中心之间进行费用的内部处理。<br>
次级成本要素的余额变化：在CO模块中，次级成本要素的余额会发生变化，归属的成本中心也会发生变化。<br>
总账的反映：总账模块不会直接反映次级成本要素的余额变化，但分配和分摊的结果会通过初级成本要素间接影响总账。</p>
]]></content>
    <category term="SAP"/>
    <published>2025-07-04T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">ABAP 日期函数</title>
    <id>https://blog.ysf.cc/sap/abap/datefunction.html</id>
    <link href="https://blog.ysf.cc/sap/abap/datefunction.html"/>
    <updated>2025-06-30T10:10:44.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h3>1. 获取输入日期当前月份最后一天的日期</h3>
<p>LAST_DAY_OF_MONTHS</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATA</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">DATUM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*获取输入日期当前月份最后一天的日期</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'LAST_DAY_OF_MONTHS'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    DAY_IN                  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '20250601'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   LAST_DAY_OF_MONTH       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATA  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"20250630</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   DAY_IN_NO_DATE          = 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   OTHERS                  = 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &lt;&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* Implement suitable error handling here</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">ELSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  WRITE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATA.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>2.  获取输入日期过去N月的日期</h3>
<p>CCM_GO_BACK_MONTHS</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATA</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">DATUM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*获取输入日期过去N月的日期</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CCM_GO_BACK_MONTHS'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    CURRDATE         </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '20250601'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    BACKMONTHS       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 7</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   NEWDATE          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATA </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"20241101</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">WRITE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATA.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>3. 获取输入日期后来N月的日期</h3>
<p>MONTH_PLUS_DETERMINE</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATA</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">DATUM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*获取输入日期后来N月的日期</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'MONTH_PLUS_DETERMINE'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    MONTHS  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 7</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    OLDDATE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '20250601'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    NEWDATE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATA. </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"20260101</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">WRITE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATA.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>4. 获取输入日期该天是星期几/周几</h3>
<p>DAY_IN_WEEK</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_WOTNR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> P</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*获取输入日期该天是星期几/周几</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'DAY_IN_WEEK'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    DATUM         </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '20250601'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   WOTNR         </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_WOTNR</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"7  =&gt; 周日</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">WRITE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_WOTNR.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>5. 将标准日期格式转换为内部数字格式</h3>
<p>日期的格式与用户参数有关，转化为内部数字格式时，都为：YYYYMMDD.</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">DATUM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*将标准日期格式转换为内部数字格式</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CONVERT_DATE_TO_INTERNAL'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    DATE_EXTERNAL                  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '2025.06.01'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   ACCEPT_INITIAL_DATE            =</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   DATE_INTERNAL                  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   DATE_EXTERNAL_IS_INVALID       = 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   OTHERS                         = 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &lt;&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* Implement suitable error handling here</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">WRITE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATE.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>6. 比较两个日期大小，返回结果是关系操作符：GT、EQ、LT</h3>
<p>比较两个日期大小，返回结果是关系操作符：GT、EQ、LT</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">TYPE-POOLS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TRFF.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LOG_OP</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TRFF_TYPE_C_2.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*比较两个日期大小，返回结果是关系操作符：GT、EQ、LT</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'FIMA_DATE_COMPARE'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    I_FLG_INTRADAY </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ' '</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    I_DATE         </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '20250601'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    I_TIME         </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '000000'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    I_SINCL        </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '0'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    I_SULT         </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ' '</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    I_COMP_DATE    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '20250623'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    I_COMP_TIME    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '000000'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    I_COMP_SINCL   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '0'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    I_COMP_SULT    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ' '</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    E_LOG_OP       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LOG_OP.</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"LT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">WRITE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LOG_OP.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>7. 获取所有的月份名字信息</h3>
<p>获取所有的月份名字信息</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*获取所有的月份名字信息</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> RETURN_CODE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> MONTH_NAMES</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE STANDARD TABLE OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> T247.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'MONTH_NAMES_GET'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">   LANGUAGE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                    =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">LANGU</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   RETURN_CODE                 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> RETURN_CODE</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  TABLES</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    MONTH_NAMES                 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> MONTH_NAMES</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   MONTH_NAMES_NOT_FOUND       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">   OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                      =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &lt;&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* Implement suitable error handling here</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">CL_DEMO_OUTPUT=&gt;DISPLAY( MONTH_NAMES ).</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><figcaption>alt text</figcaption></figure>
<h3>8. 为 F4 帮助显示日历，弹出日历对话框，供用户选择日期</h3>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*为 F4 帮助显示日历，弹出日历对话框，供用户选择日期</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">PARAMETERS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:P1(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> C</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">AT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> SELECTION-SCREEN ON</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> VALUE-REQUEST</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FOR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P1.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: L_DATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">DATUM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'F4_DATE'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      DATE_FOR_FIRST_MONTH </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">DATUM</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     DISPLAY              = ' '</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     FACTORY_CALENDAR_ID  = ' '</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     GREGORIAN_CALENDAR_FLAG            = ' '</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     HOLIDAY_CALENDAR_ID  = ' '</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     PROGNAME_FOR_FIRST_MONTH           = ' '</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     DATE_POSITION        = ' '</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      SELECT_DATE          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> L_DATE </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"用户选择后返回的日期</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     SELECT_WEEK          =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     SELECT_WEEK_BEGIN    =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     SELECT_WEEK_END      =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     CALENDAR_BUFFER_NOT_LOADABLE       = 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     DATE_AFTER_RANGE     = 2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     DATE_BEFORE_RANGE    = 3</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     DATE_INVALID         = 4</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     FACTORY_CALENDAR_NOT_FOUND         = 5</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     HOLIDAY_CALENDAR_NOT_FOUND         = 6</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     PARAMETER_CONFLICT   = 7</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     OTHERS               = 8</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &lt;&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* Implement suitable error handling here</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  P1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> L_DATE.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>9. 为 F4 帮助显示时间，弹出时间对话框，供用户选择时间</h3>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*为 F4 帮助显示时间，弹出时间对话框，供用户选择时间</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">PARAMETERS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:P1(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> C</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">AT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> SELECTION-SCREEN ON</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> VALUE-REQUEST</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FOR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P1.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> L_TIME</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">UZEIT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'F4_CLOCK'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">   EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">     START_TIME          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">UZEIT</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">     DISPLAY</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">             =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ' '</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">   IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">     SELECTED_TIME       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> L_TIME</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  P1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> L_TIME.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>参考文献</h2>
]]></content>
    <category term="SAP"/>
    <published>2025-06-19T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">SMARTFORMS和内表转附件 发送邮件</title>
    <id>https://blog.ysf.cc/sap/abap/sapmail.html</id>
    <link href="https://blog.ysf.cc/sap/abap/sapmail.html"/>
    <updated>2025-06-16T08:43:48.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>1.背景</h2>
<p>基于CL_BCS，将SAP Smartforms和内表分别转为PDF和xlsx格式的附件发送邮件。</p>
<h2>2.准备工作</h2>
<p>确保SAP能发送邮件，参考这个大佬的文章进行配置<a href="https://www.cnblogs.com/jxzhu/p/11957516.html" target="_blank" rel="noopener noreferrer">2019.11.29 SAP SMTP郵件服務器配置 發送端 QQ郵箱-TAB_Zhu</a></p>
<h2>3.可能相关事务代码</h2>
<p>SICF           HTTP 服务层次结构维护<br>
SPROXY         ABAP Procy Generation<br>
SMICM          ICM 监控器<br>
RZ10           维护参数文件参数<br>
SBWP           SAP 业务工作台(发送邮件功能)<br>
SCOT           SAP connect 管理<br>
SOST           SAP 连接发送请求(所有待发送的邮件清单，也可以监视邮件发送状态，也可以在此页面发送邮件！)<br>
SE78           表格图形管理<br>
SMARTFORMSSAP  智能表格<br>
SE71           SAP script 格式<br>
SFP            表格构建器(adobe)<br>
NACE           WFMC：初始定制屏幕<br>
ME9F           消息输出: 采购订单</p>
<h2>4.Smartforms转PDF并添加为邮件附件</h2>
<h3>4.1获取Smartforms的XSTRING文件</h3>
<p>获取加密函数模块名，调用Smartforms<br>
主要参数为以下三个参数：<br>
no_dialog：       保证不显示弹窗<br>
tdnewid：          设置创建假脱机请求<br>
user_settings：置空，保证上面两个参数生效</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: FM_NAME      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> RS38L_FNAM.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: GWA_RESULT   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SSFCRESCL,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        GWA_OUTPUT   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SSFCOMPOP,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        GWA_CONTROL  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SSFCTRLOP.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*DATA: LS_HEAD TYPE ZMMS010, "定义表头内表</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      LT_ITEM TYPE TABLE OF ZMMS010 WITH HEADER LINE. "定义表值内表</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: GV_SIZE      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> I</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        GZ_LINES     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE TABLE OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TLINE,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        GS_LINES     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SOLIX_TAB,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        LV_XSTRING   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> XSTRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.                 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"pdf附件</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  "调用Smartforms，获取加密函数模块名</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'SSF_FUNCTION_MODULE_NAME'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">     FORMNAME           </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'ZTEST01'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> "表单名</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     VARIANT            = ' '</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     DIRECT_CALL        = ' '</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      FM_NAME            </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> FM_NAME</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      NO_FORM            </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      NO_FUNCTION_MODULE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">             =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &lt;&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* Implement suitable error handling here</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  "附件PDF参数</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GWA_CONTROL-NO_DIALOG </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'X'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">. </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"不显示弹窗</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GWA_CONTROL-NO_CLOSE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ' '</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GWA_CONTROL-PREVIEW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ' '</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GWA_CONTROL-GETOTF </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'X'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GWA_CONTROL-LANGU     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">LANGU</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GWA_OUTPUT-TDNEWID   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'X'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">. </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"设置创建假脱机请求</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GWA_OUTPUT-TDIMMED   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'X'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GWA_OUTPUT-TDDELETE   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'X'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GWA_OUTPUT-TDDEST  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'LP01'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> FM_NAME</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      CONTROL_PARAMETERS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GWA_CONTROL</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      OUTPUT_OPTIONS     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GWA_OUTPUT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      USER_SETTINGS      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ''</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> "置空，保证上面两个参数生效</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      GS_HEAD            </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> IS_HEAD  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"看你SMARTFORMS需要</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      JOB_OUTPUT_INFO    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GWA_RESULT</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    TABLES</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      GT_ITEM            </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_ITEM[] </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"传值进入smartforms，看你SMARTFORMS需要</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      FORMATTING_ERROR   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      INTERNAL_ERROR     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      SEND_ERROR         </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      USER_CANCELED      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 4</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">             =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &lt;&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* Implement suitable error handling here</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>4.2调用CONVERT_OTFSPOOLJOB_2_PDF将打印池中的信息转换为PDF</h3>
<p>SAP标准参考程序：RSTXPDFT4<br>
之后你想把PDF附件以什么形式传给CL_BCS，就把XTRING转成对应格式，我这里转成二进制</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">Convert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> OTF</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> to</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PDF</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CONVERT_OTF'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      FORMAT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'PDF'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      PDF_PREVIEW           </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'X'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> "PDF预览</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      BIN_FILESIZE          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_SIZE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      BIN_FILE              </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_XSTRING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    TABLES</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      OTF                   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GWA_RESULT-OTFDATA</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      LINES</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                 =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GZ_LINES</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      ERR_MAX_LINEWIDTH     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      ERR_FORMAT            </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      ERR_CONV_NOT_POSSIBLE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      ERR_BAD_OTF           </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 4</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &lt;&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    MESSAGE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> ID</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MSGID</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MSGTY</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> NUMBER</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MSGNO</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            WITH</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MSGV1</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MSGV2</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MSGV3</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MSGV4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  "转换二进制</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'SCMS_XSTRING_TO_BINARY'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      BUFFER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">     =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_XSTRING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    TABLES</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      BINARY_TAB </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_LINES.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>4.3添加附件,可以添加多个附件</h3>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     附件长度</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  L_FILE_SIZE_CHAR </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_SIZE.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*     添加附件,可以添加多个附件</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> METHOD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LO_DOC_BCS-&gt;ADD_ATTACHMENT</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      I_ATTACHMENT_TYPE    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'BIN'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      I_ATTACHMENT_SUBJECT = '邮件测试' &amp;&amp; '.PDF'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      I_ATTACHMENT_SIZE    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> L_FILE_SIZE_CHAR</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      I_ATT_CONTENT_HEX    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_LINES.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>5.内表转xslx并添加为邮件附件</h2>
<p>BCS框架提供的文件扩展名是3位字符的，所以像xlsx，docx之类的内容将无法直接添附，如果需要添附4位扩展名的文件作为附件，需要使用关键字"&amp;SO_FILENAME="来确定附件名称和类型。<br>
生成的xslx文件的首行描述根据你数据元素的字段标签生成，当然你的fieldcat也可以自己手动创建<br>
</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_AUFM</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> LIKE TABLE OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> AUFM.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* 1.  准备内表数据</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  SELECT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> *</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INTO</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> CORRESPONDING</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FIELDS OF TABLE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_AUFM</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> AUFM</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">   WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> AUFNR </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> S_AUFNR.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* 2.将内表转换为xslx格式</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">PERFORM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> FRM_GET_IT_XSLX_SOLIX </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">CHANGING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_ATTCH-BODY_CONTENT LS_ATTCH-SIZE.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* 3.添加附件,可以添加多个附件</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> METHOD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LO_DOC_BCS-&gt;ADD_ATTACHMENT</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      I_ATTACHMENT_TYPE    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'BIN'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      I_ATTACHMENT_SUBJECT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '测试文件.XSLX'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      I_ATTACHMENT_SIZE    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_ATTCH-SIZE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      I_ATTACHMENT_HEADER  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '&amp;SO_FILENAME=测试文件.XSLX'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      I_ATT_CONTENT_HEX    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_ATTCH-BODY_CONTENT.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">FORM</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> FRM_GET_IT_XSLX_SOLIX</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    CHANGING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CS_ATTCH_BODY_CONTENT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SOLIX_TAB</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                                     CS_ATTCH_SIZE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SO_OBJ_LEN</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  TYPES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    BEGIN OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TY_TEST,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      USERID  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> STRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      USERNAME</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> STRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    END OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TY_TEST,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    TT_TEST</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE STANDARD TABLE OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TY_TEST.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    LT_TEST    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TT_TEST,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    LV_XSTRING </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> XSTRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    LV_STRING  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> STRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    LV_CODEPAGE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CPCODEPAGE.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    LO_BCS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE REF TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CX_BCS.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* 添加附件,可以添加多个附件</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  FIELD-SYMBOLS</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FS_TAB&gt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE STANDARD TABLE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">LT_DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">= REF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> #( GT_AUFM ).</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ASSIGN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_DATA-&gt;*</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TO</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FS_TAB&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  TRY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      TRY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> METHOD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CL_SALV_TABLE=&gt;FACTORY</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              LIST_DISPLAY </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> IF_SALV_C_BOOL_SAP=&gt;FALSE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*             R_CONTAINER  =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*             CONTAINER_NAME =</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              R_SALV_TABLE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">SALV_TABLE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CHANGING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              T_TABLE      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FS_TAB&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        CATCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CX_SALV_MSG.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          RETURN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      ENDTRY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">LT_FCAT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                         R_COLUMNS      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SALV_TABLE-&gt;GET_COLUMNS( )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                         R_AGGREGATIONS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SALV_TABLE-&gt;GET_AGGREGATIONS( )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                 )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                         .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    CATCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CX_SALV_MSG.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      RETURN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  ENDTRY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">CL_SALV_BS_LEX=&gt;EXPORT_FROM_RESULT_DATA_TABLE(</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">           IS_FORMAT                     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> IF_SALV_BS_LEX_FORMAT=&gt;MC_FORMAT_XLSX</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">           IR_RESULT_DATA_TABLE          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CL_SALV_EX_UTIL=&gt;FACTORY_RESULT_DATA_TABLE(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">           R_DATA </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_DATA</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">           T_FIELDCATALOG </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_FCAT </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"fieldcat</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">           )</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      IR_FORMATTING_DESCRIPTORS     =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      IRT_HEADER_FORMAT_DESCRIPTORS =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      IR_APPENDIX_BLOCKS            =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      IV_GROUP_HANDLES_ENABLED      = ABAP_FALSE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      IV_THEME                      =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      IV_GUIDELINE                  =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      IO_STREAMING_TASK             =</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">           ER_RESULT_FILE                </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_XSTRING ).</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      ET_EXPORT_ERRORS              =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      ES_FILENAME                   =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      ES_MIMETYPE                   =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      ES_FILE_EXTENSION             =</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    TRY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        CL_BCS_CONVERT=&gt;XSTRING_TO_SOLIX(</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          IV_XSTRING </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_XSTRING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        RECEIVING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          ET_SOLIX </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CS_ATTCH_BODY_CONTENT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        ).</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        CS_ATTCH_SIZE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> XSTRLEN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">( LV_XSTRING ).</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      CATCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CX_BCS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LO_BCS.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ENDTRY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ENDFORM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>6.SE37 SMARTFORMS转PDF完整Demo</h2>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">FUNCTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ZMMFU021.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div>]]></content>
    <category term="SAP"/>
    <published>2025-06-13T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">SD学习</title>
    <id>https://blog.ysf.cc/sap/abap/sdstudy.html</id>
    <link href="https://blog.ysf.cc/sap/abap/sdstudy.html"/>
    <updated>2025-05-30T05:53:21.000Z</updated>
    <summary type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
<!-- more -->
<ul>
<li>1.销售业务流程<br>
销售一般流程包括销售订单、创建交货单、发货过账、出具发票、发票“批准至会计”形成应收款<br>
</li>
</ul>
]]></content>
    <category term="SAP"/>
    <published>2025-05-30T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">软件</title>
    <id>https://blog.ysf.cc/favorite/links/5.software.html</id>
    <link href="https://blog.ysf.cc/favorite/links/5.software.html"/>
    <updated>2025-09-12T03:15:08.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<div class="hint-container tip">
<p class="hint-container-title">好用的软件</p>
</div>
<h2></h2>
]]></content>
    <published>2025-05-23T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">与企业微信集成</title>
    <id>https://blog.ysf.cc/sap/abap/integratewechatwork.html</id>
    <link href="https://blog.ysf.cc/sap/abap/integratewechatwork.html"/>
    <updated>2025-05-29T06:47:35.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>调用API推送消息</h2>
<h2>参考文献</h2>
<ul>
<li><a href="https://blog.csdn.net/HeathlX/article/details/139523327" target="_blank" rel="noopener noreferrer">ABAP - SAP与企业微信集成-推送文本消息到企业微信</a></li>
<li><a href="https://developer.work.weixin.qq.com/document/36372?vid=1688854890519433&amp;deviceid=daabe441-d1f5-4bf5-aea4-889a4804abd7&amp;version=4.1.36.6011&amp;platform=win" target="_blank" rel="noopener noreferrer">服务端 API 错误码查询工具</a></li>
</ul>
]]></content>
    <category term="SAP"/>
    <published>2025-05-29T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">FICO学习</title>
    <id>https://blog.ysf.cc/sap/fico/ficoknowledge.html</id>
    <link href="https://blog.ysf.cc/sap/fico/ficoknowledge.html"/>
    <updated>2025-07-10T01:58:09.000Z</updated>
    <summary type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
<!-- more -->
<h2>1. 资产科目和负债科目与借贷</h2>
<p>资产科目正常金额应该在借方。<br>
负债科目正常金额应该在贷方。<br>
负债类会计科目遵循 “贷方记增加，借方记减少” 的记账规则，贷方科目余额减少，表示债务的清偿。应付账款的正常余额是在贷方，应付账款是一种负债。<br>
举例-如果某个供应商的应付账款科目期末余额在借方，可能表示企业已经预先支付了部分款项给供应商，或者由于退货、折扣等原因，实际应付金额比之前记录的应付金额要少，从而导致期末余额出现在借方，应通过重分类或者啥将其调整到预付款科目。</p>
<p>报表：<br>
会计凭证里如果借20贷20，凭证里贷方金额是-20显示。<br>
资产负债表 资产是1×××××的科目<br>
负债是2×××××的科目，要乘-1，<br>
权益是4×××××的科目，要乘-1.<br>
最后是资产=负债+权益</p>
<h2>2. 外币评估</h2>
<p>外币评估</p>
<ul>
<li>
<p>货币资金类科目，即外币类的现金、银行存款科目。已实现的汇兑损益，对他进行的月末重估外币评估凭证不用在下月初冲回。<br>
汇兑损益 = 累计外币余额 * 月末汇率 - 本位币余额。</p>
</li>
<li>
<p>将以固定或可确定的金额收取的资产或者偿付的负债，是指以外币记录的应收账款、应付账款等。对于这类科目，应针对其未清项发生金额(而不是累计金额)进行重估。<br>
汇兑损益 = ∑ (外币金额 * 月末汇率 - 未清项的本位币金额)。<br>
未清项的月末评估是企业对与外部往来单位之间的债权、债务的评估。在债权、债务被清掉之前，不算是"既成事实"，应称为"未实现的汇兑损益"，因此，此凭证在下月初一般应冲回。等到将来收款或者付款清掉债权债务时，再按当时的汇率计算"已实现的汇兑损益"。</p>
</li>
</ul>
<h2>清账</h2>
<h2>重分类</h2>
<h2>总价 净价 有效价</h2>
<p>SAP自己定义的三种价格，Gross Price总价，Net Price净价，Effective Price有效价.</p>
<p><em>总价（Gross Price）</em>= 不包含任何折扣与附加费用的原始物料报价<br>
<em>净价（Net Price）</em>= 总价+各种折扣和附加费（但现金折扣除外）<br>
<em>有效价（Effective Price）</em>= 净价 - 现金折扣+各种费用（运费&amp;手续费&amp;不可抵扣税额）  税在这？<br>
<a href="https://blog.csdn.net/lychee7758521/article/details/81877145#:~:text=%E6%80%BB%E4%BB%B7%EF%BC%88Gross%20Price%EF%BC%89%20%3D%20%E4%B8%8D%E5%8C%85%E5%90%AB%E4%BB%BB%E4%BD%95%E6%8A%98%E6%89%A3%E4%B8%8E%E9%99%84%E5%8A%A0%E8%B4%B9%E7%94%A8%E7%9A%84%E5%8E%9F%E5%A7%8B%E7%89%A9%E6%96%99%E6%8A%A5%E4%BB%B7%20%E5%87%80%E4%BB%B7%EF%BC%88Net%20Price%EF%BC%89%20%3D%20%E6%80%BB%E4%BB%B7%2B%E5%90%84%E7%A7%8D%E6%8A%98%E6%89%A3%E5%92%8C%E9%99%84%E5%8A%A0%E8%B4%B9%EF%BC%88%E4%BD%86%E7%8E%B0%E9%87%91%E6%8A%98%E6%89%A3%E9%99%A4%E5%A4%96%EF%BC%89,Price%EF%BC%89%20%3D%20%E5%87%80%E4%BB%B7%20-%20%E7%8E%B0%E9%87%91%E6%8A%98%E6%89%A3%2B%E5%90%84%E7%A7%8D%E8%B4%B9%E7%94%A8%EF%BC%88%E8%BF%90%E8%B4%B9%26%E6%89%8B%E7%BB%AD%E8%B4%B9%26%E4%B8%8D%E5%8F%AF%E6%8A%B5%E6%89%A3%E7%A8%8E%E9%A2%9D%EF%BC%89%20%E5%87%BA%E8%87%AA%EF%BC%9A%20https%3A%2F%2Fblog.csdn.net%2Fkangliujie%2Farticle%2Fdetails%2F75048239%20%E6%96%87%E7%AB%A0%E6%B5%8F%E8%A7%88%E9%98%85%E8%AF%BB1.4k%E6%AC%A1%E3%80%82" target="_blank" rel="noopener noreferrer">总价，净价，有效价-睿越</a></p>
<h2>如果一个FI凭证既挂了内部订单又挂了成本中心</h2>
<p>根据内部订单的类型判断，如果是统计性内部订单，那进成本中心。<br>
如果是实际型内部订单，不进成本中心进内部订单。<br>
结算规则只是实际型内部订单特有功能的一个体现。一般与结算规则就进内部订单吧？</p>
]]></content>
    <category term="SAP"/>
    <published>2025-04-27T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">PP学习</title>
    <id>https://blog.ysf.cc/sap/abap/ppstudy.html</id>
    <link href="https://blog.ysf.cc/sap/abap/ppstudy.html"/>
    <updated>2025-09-12T03:15:08.000Z</updated>
    <summary type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
<!-- more -->
<h2>1. 生产订单执行</h2>
<p>该公司的业务反正是这样的:生产订单的领料都是车间根据生产计划然后按照BOM用表格计算的领料需求，投料那个实际就是报工的时候一起做的，系统也会根据工单计算出投料数量，我的理解是工单生成的时候投料的物料需求就生成了，原材料从中心仓到线边仓移动一般都是生产的前一天，跟工单的关系其实不太大，工单我们都是提前一周或者一个月就建好，然后每周调整的</p>
<p>先领料411(TF库存地到库存地,中心仓-&gt;中心分仓-&gt;线边仓)再投料261(计入生产订单的生产成本)<br>
领料是领到线边仓(从中心仓掉一堆原材料放在产线旁边，然后随着当天的生产领用，一点点的上料到产线上)<br>
创建工单-&gt;领料-&gt;报工确认(确认工时与进行投料和收货)<br>
创建工单时会自动创建预留，该公司是创建的261投料的预留，锁定线边仓的库存。</p>
<h2>2. 内部订单</h2>
<p>内部订单如研发订单，研发订单领料原材料物料库存价值转研发费用(没使用完一般不会退回至仓库库存)。内部订单产出类似于收货研发订单产出成品研发费用转库存价值。感觉像生产订单只是没有工艺路线和bom这种。<br>
<br>
</p>
<h3>2.1 内部订单记账</h3>
<p>费用记账 科目分配类别F<br>
内部订单分为统计型内部订单-统计记账<br>
非统计型内部订单-真实记账<br>
如果同时输入内部订单和成本中心<br>
| 情形| 内部订单的性质 | 成本中心的性质|<br>
|</p>
]]></content>
    <category term="SAP"/>
    <published>2025-04-30T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">断点</title>
    <id>https://blog.ysf.cc/sap/abap/breakpoint.html</id>
    <link href="https://blog.ysf.cc/sap/abap/breakpoint.html"/>
    <updated>2025-05-15T10:01:04.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<ul>
<li>会话断点</li>
<li>用户断点</li>
<li>一些后台任务前两个都加不了，/H-&gt;更新调试，然后打会话/用户断点进行调试。</li>
<li>前三种都不行，把东西卡在SMQ2里，再进调试</li>
</ul>
<h2>参考文献</h2>
]]></content>
    <category term="SAP"/>
    <published>2025-05-07T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">自动报工</title>
    <id>https://blog.ysf.cc/sap/abap/automaticjobreporting.html</id>
    <link href="https://blog.ysf.cc/sap/abap/automaticjobreporting.html"/>
    <updated>2025-06-11T07:07:47.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<p>表:<br>
*AFKO    订单表头数据 PP 订单<br>
*AFVC    订单的工序<br>
AFVV    工序中数量/日期/值的DB结构<br>
PLPO    任务清单 - 工序/作业<br>
AFFW    带有来自确认的错误的货物移动<br>
AFRU    订单确认<br>
AFWI    随后过帐的确认货物移动<br>
AUFM    针对订单的货物移动</p>
<p>开发自检，需要考虑的点：<br>
一. 确认报工是否同时入库<br>
二. 确定报工数量是否可超量<br>
三. 判断工单状态<br>
四. PP报工函数</p>
<p>BAPI:<br>
BAPI_PRODORDCONF_GET_TT_PROP<br>
BAPI_PRODORDCONF_CREATE_TT</p>
<h2>自动报工流程</h2>
<p>根据生产订单找到他的工序，判断是否需要反冲投料和自动收货(根据工序的控制码决定)。调用BAPI进行自动报工</p>
<h2>万向批次号</h2>
<p>增强字段<br>
在MCH1更新万向批次号字段(会更新到MSC3N批次数据增强字段万向批次号上)<br>
在ZMSEG更新万向批次号字段(会更新到MB51物料凭证增强字段万向批次号上)</p>
<h2>参考文献</h2>
<ul>
<li><a href="https://blog.csdn.net/weixin_42400703/article/details/135536449" target="_blank" rel="noopener noreferrer">【SAP-PP】PP工单报工-CO15</a></li>
<li><a href="https://blog.csdn.net/DeveloperMrMeng/article/details/139811212" target="_blank" rel="noopener noreferrer">SAP CO11N BAPI_PRODORDCONF_CREATE_TT连续报工异步更新导致COGI解决方案</a></li>
<li><a href="https://blog.csdn.net/DeveloperMrMeng/article/details/140174352?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">SAP 报工BAPI中的 UPDATA TASK 和 BACKGROUND TASK</a></li>
<li><a href="https://blog.csdn.net/DeveloperMrMeng/article/details/140377250?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">SAP ABAP调用BAPI时COMMIT WORK AND WAIT未按照预期同步提交问题分析</a></li>
<li><a href="https://blog.csdn.net/u010837413/article/details/140664748?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1-140664748-blog-144586173.235%5Ev43%5Epc_blog_bottom_relevance_base5&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=4" target="_blank" rel="noopener noreferrer">SAP生产订单（创建-下达-发料-报工-入库）全流程及反向流程</a></li>
</ul>
]]></content>
    <category term="SAP"/>
    <published>2025-05-08T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">MM运维</title>
    <id>https://blog.ysf.cc/sap/abap/mmoperations.html</id>
    <link href="https://blog.ysf.cc/sap/abap/mmoperations.html"/>
    <updated>2025-05-29T06:47:35.000Z</updated>
    <summary type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
<!-- more -->
<h2>1.VL31N创建交货单时报错通知数量超过仍然未清的通知数量11,203.000 EA</h2>
<p>表-EKES供应商确认<br>
通过表EKES查看供应商确认表发现是有一笔单子数量没更新<br>
当入库的采购订单已经收货，做退货交货出库单，一笔退货好像是突然又不退了，因为我们有内嵌的EWM，在EWM把数量改为0，但SAP的退货交货出库单里数量还是6占用了数量。他们改的表，总感觉怪怪的，觉得有其他更好的方法不用改表我猜。<br>
<br>
<br>
<br>
解决方法：<br>
改表EKES使MENGE按照供应商确认的数量和DABMG已减少数量 (MRP)数量一致</p>
]]></content>
    <category term="SAP"/>
    <published>2025-04-24T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">RFUI框架与ITS服务，PDA</title>
    <id>https://blog.ysf.cc/sap/abap/rfits.html</id>
    <link href="https://blog.ysf.cc/sap/abap/rfits.html"/>
    <updated>2025-04-27T06:52:20.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>背景</h2>
<h2>介绍</h2>
<h2>参考文献</h2>
<p><a href="/file/%E5%8F%91%E5%B8%83RFUI-ITS%E6%9C%8D%E5%8A%A1.docx" title="下载文档">下载发布RFUI-ITS服务.docx</a><br>
<a href="/file/EWM.pptx" title="下载文档">下载EWM.pptx</a><br>
<a href="https://blog.csdn.net/lilysesy/article/details/143994057" target="_blank" rel="noopener noreferrer">创建Internet服务将事务代码封装成http发布扫码枪-LilySesy</a></p>
]]></content>
    <category term="SAP"/>
    <published>2025-04-23T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">PP运维</title>
    <id>https://blog.ysf.cc/sap/pp/ppoperationandmaintenance.html</id>
    <link href="https://blog.ysf.cc/sap/pp/ppoperationandmaintenance.html"/>
    <updated>2025-09-12T03:15:08.000Z</updated>
    <summary type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
<!-- more -->
<h2>1. M7 022 订单81000031832在0020工序报工报错</h2>
<p><br>
COGI中这个错误，一般是因为生产订单已经做了收货，并且生产订单不允许过量交货，所以报了这个错，看下生产订单是不是已经入库了<br>
报工收货？那你把报工数量改为零 只扣料</p>
<p>原因：报工报多了，所以入库入不了<br>
<br>
<br>
</p>
<p>解决方法:</p>
<ol>
<li>修改了生产订单的数量使其大于报工数量，然后再报工<br>
<br>
<br>
</li>
</ol>
<!-- [PO 发布外围系统REST-＞SAP RFC同步接口-Seele_1018](https://blog.csdn.net/qq_44826887/article/details/134922069)
[PO 发布SAP SProxy-＞外围系统 WebService-Seele_1018](https://blog.csdn.net/qq_44826887/article/details/135170299) -->
<h2>2. KL 023 版本 000 / 2025 作业计划/数量计划中没有 作业类型 1000/6000F01104/WX01 的控制记录</h2>
<p>事物代码KP27<br>
创建生产订单时报的错。但可以保存生产订单，好像报工的时候的物料移动无效，物料凭证不生成<br>
</p>
<ul>
<li>参考文献<br>
<a href="https://zhuanlan.zhihu.com/p/440716348" target="_blank" rel="noopener noreferrer">SAP中成本核算时提示没有作业类型控制记录的实例</a></li>
</ul>
<h2>3. CO 893 计划订单1不能从 1转换-&gt;记录</h2>
<p>计划订单没有对应的生产版本。<br>
可能是创建计划订单的时候生产版本过期了所以没有带出来。</p>
<p>解决方法:</p>
<ol>
<li>先修改物料的生产版本的有效期</li>
<li>MD12修改计划订单，维护生产版本<br>
<br>
</li>
</ol>
<ul>
<li>参考文献<br>
<a href="https://blog.csdn.net/fish_yu_yu/article/details/146524425" target="_blank" rel="noopener noreferrer">SAP中计划订单集中转换报错处理</a></li>
</ul>
<h2>4. CO 691 你必须输入物料 104007600 的批</h2>
<p>生产订单的组件(预留单resb数据)，一般生产订单下达的时候不用输入具体的批次号<br>
报工的时候系统会自动根据需求带出批次号，因为这个物料批量输入字段被人从空改成了1所以需要在<br>
生产订单组件中输入批次号。</p>
<p>解决方法:<br>
将物料主数据修正<br>
<br>
<br>
</p>
]]></content>
    <category term="SAP"/>
    <published>2025-04-15T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">FICO运维</title>
    <id>https://blog.ysf.cc/sap/fico/operations.html</id>
    <link href="https://blog.ysf.cc/sap/fico/operations.html"/>
    <updated>2025-07-16T02:44:30.000Z</updated>
    <summary type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<!-- :::tip
::: -->
<!-- 摘要截止标签 -->
<!-- more -->
<h2>1. F5 788科目导入凭证报错(ZFIFU002) 调节帐户或快键不允许</h2>
<p>| BAPI | BAPI描述 |<br>
|</p>
]]></content>
    <category term="SAP"/>
    <published>2025-04-01T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">财务替代</title>
    <id>https://blog.ysf.cc/sap/abap/replace.html</id>
    <link href="https://blog.ysf.cc/sap/abap/replace.html"/>
    <updated>2025-03-18T04:44:38.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>GGB1</h2>
<p>替代步骤：</p>
<ol>
<li>事务代码SE38，将程序 RGGBR000复制为ZRGGBR000</li>
<li>事务代码GCX2，维护应用区域GBLS退出程序ZRGGBR000</li>
<li>事务代码GGB1，维护替代。</li>
<li>事务代码GGB4/OBBH,激活替代。<br>
因为GGB0不会生成请求，需要通过事务码去生成，也可以前台按对应按钮<br>
校验的请求生成：GCT9<br>
替代的请求生成：GCT0<br>
替代：GGB1；单击创建的替换，输入 =SHCB ， 回车OBBH<br>
校验：GGB0，单击创建的校验，输入 =SHCD ， 回车OB28</li>
</ol>
<p>传输的时候如果是整个替代文件夹传输，先看下里面内容和正式机是否一致，有可能100有修改，300也有导致替代缺失。<br>
如果替代是退出，需要在对应ZRGGBS000的子例程中更新子例程信息(FORM)，否则无法进行双击导航。</p>
<h2>BTE FIBF</h2>
<p>替代步骤：SAMPLE_PROCESS_00001120为例</p>
<ol>
<li>进入事务码FIBF, 查找业务交易事件00001120 (凭证过帐: 字段替代表头/项目)以及与之对应的SAMPLE 函数SAMPLE_PROCESS_00001120</li>
<li>根据SAMPLE函数创建自定义Z函数</li>
<li>创建产品</li>
<li>将业务交易事件、产品以及自定义Z函数关联起来</li>
</ol>
<p>T_BKPF, T_BSEG 和 T_BSEG 三个 table 参数的作用是提供信息，但不能被修改。能修改的只有 T_BKPFSUB 和 T_BSEGSUB 。</p>
<p>BTE替代本质上是一个配置？不能跨客户端，只在当前客户端有效。</p>
<h2>参考文献</h2>
<p><a href="https://www.jianshu.com/p/a8e2287ec4fa/" target="_blank" rel="noopener noreferrer">BTE</a><br>
<a href="https://blog.csdn.net/weixin_37949164/article/details/120871386" target="_blank" rel="noopener noreferrer">BTE</a><br>
<a href="https://blog.csdn.net/hnlyscq888/article/details/126267396" target="_blank" rel="noopener noreferrer">SAP 替代，确认_sap替代-狸花猫小叶子</a><br>
<a href="https://zhuanlan.zhihu.com/p/165402109?utm_id=0" target="_blank" rel="noopener noreferrer">一文精通SAP凭证有效性和替代-天师爱美丽</a><br>
<a href="https://blog.csdn.net/xiaofei2008gxh/article/details/134003999" target="_blank" rel="noopener noreferrer">SAP FI 替代和校验以及激活 RGUGBR00-gavin_gxh</a></p>
]]></content>
    <category term="SAP"/>
    <published>2025-03-10T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">idoc与edi</title>
    <id>https://blog.ysf.cc/sap/abap/idocedi.html</id>
    <link href="https://blog.ysf.cc/sap/abap/idocedi.html"/>
    <updated>2025-03-18T04:44:38.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>背景</h2>
<h2>介绍</h2>
<h2>参考文献</h2>
<p><a href="https://www.cnblogs.com/saper/p/6123848.html" target="_blank" rel="noopener noreferrer">IDOC配置-返回主页SAP梦心</a></p>
]]></content>
    <category term="SAP"/>
    <published>2025-03-11T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">CKM3物料价格分析报表</title>
    <id>https://blog.ysf.cc/sap/abap/materialpriceanalysis.html</id>
    <link href="https://blog.ysf.cc/sap/abap/materialpriceanalysis.html"/>
    <updated>2025-04-10T07:45:17.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<p>表:KEKO/MBEW/mldoc/MLDOCCCS/CKMLCR<br>
事物代码:CKM3(N)<br>
想要开发一个和CKM3大致的批量显示收货和和期末库存的报表，成本会计做成本的报表还是成本分析啥的吧我猜的。<br>
下面这个报表的如果筛选的月份是当月，但没有跑物料分类账。其中期末库存前面的值是对的，但因为我圈起来的料工费这种由实际值拆分得来的(还有前面的价格差异也不对)，但我代码里写的时候是根据期初加收货减消耗这种算出来的，所以不太对。没有跑物料分类账的话MLDOC里就不会有EB这些行<br>
<br>
<br>
可以改一下由期末库存的实际值乘以对应的拆分比例算，然后价格差异的话也要算一下，没有找到那个比例在哪懒得改了，就先放着吧。反正看报表应该也是看结完后的🍄<br>
跑完物料分类账后，期末库存会多一行结算，就是由原本标准成本的值变成了移动平均价的值(跟库存价值有关了)，这个结算行应该就是移动平均价和标准价的价值的差异。<br>
<br>
<br>
</p>
<h2>和参考文献中不同点</h2>
<ol>
<li>
<p>期初+ZU收货+PC重新评估(因标准价格修改进行重新评估价格更改的标准成本)-VN消耗=期末标准成本<br>
</p>
</li>
<li>
<p>我的期初标准成本计算方法为：(按文章里的直接取不太对)</p>
</li>
</ol>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">DATUM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      GV_DATE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> S_GJAHR-LOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">&amp;&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> S_POPER-LOW+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">&amp;&amp;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '01'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CCM_GO_BACK_MONTHS'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          CURRDATE   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          BACKMONTHS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '001'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          NEWDATE    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GV_DATE.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      SELECT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> SINGLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> *</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> @</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">GS_CKMLCR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CKMLCR</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">       WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> KALNR </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> @</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">&lt;FS_OUT&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-KALN1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         AND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> BDATJ </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> @GV_DATE+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         AND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> POPER </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> @GV_DATE+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">      &lt;FS_OUT&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-STVAL </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FS_OUT&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-QUANT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_CKMLCR-STPRS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_CKMLCR-PEINH.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>CKMLCR表中上个月的标准价格乘以期初数量除以上个月的价格单位</p>
<h2>实际代码</h2>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*&amp;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content>
    <category term="SAP"/>
    <published>2025-03-03T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">SAP(WMS)-WCS-AGV(PLC)对接</title>
    <id>https://blog.ysf.cc/sap/abap/wcs/agv-sap-integration.html</id>
    <link href="https://blog.ysf.cc/sap/abap/wcs/agv-sap-integration.html"/>
    <updated>2025-03-07T05:01:39.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>背景</h2>
<p>WCS 是现代物流和供应链管理中不可或缺的一部分，通过与 WMS 和 PLC 的协同工作，实现了仓储业务的高效、精确执行，帮助企业提升物流效率，降低成本，提高客户满意度。<br>
AGV（Automated Guided Vehicle，自动导向车）是一种自动导向车，用于自动化物料搬运。它在仓库、工厂和配送中心等环境中，按照预设路径或导航系统自主运输货物。<br>
工作原理<br>
AGV：依赖导航系统（如磁条、激光导航等）和传感器来定位和躲避障碍物，通常由控制系统（可能是PLC或其他控制器）调度和管理，但自身不是PLC。<br>
AGV系统：通常包括多辆AGV小车、服务器、调度系统、数据库、电池充电系统等。<br>
虽然AGV系统可能由PLC进行控制，是一个独立的自动化运输设备。<br>
WCS：WCS 作为集成的物流管理系统，可以与 WMS、ERP、SCM、SCM 等系统协同工作，实现仓储业务的自动化、精确化。</p>
<h2>接口清单</h2>
<ul>
<li>SAP-&gt;WCS上层任务下发接口<br>
触发节点 /SCWM/IF_EX_CORE_CR_POST~POST</li>
<li>WCS-&gt;SAP任务完成上报接口</li>
<li>WCS-&gt;SAP请求任务接口</li>
</ul>
<h2></h2>
<ol>
<li>物料移动产生仓库任务</li>
<li>HU移动产生仓库任务</li>
</ol>
<p>ME21N创建采购订单-&gt;VL31N创建入库交货-&gt;/N/SCWM/PRDI收货-&gt;<br>
/N/SCWM/pack包装(产生仓库任务无HU)-&gt;/N/SCWM/PRDI创建HU仓库任务(SAP-&gt;WCS上层任务下发接口)-&gt;<br>
/N/SCWM/TO_CONF仓库任务确认(WCS-&gt;SAP任务完成上报接口)</p>
<h2>参考文献</h2>
]]></content>
    <category term="SAP"/>
    <published>2025-02-11T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">对象或者表的更改记录</title>
    <id>https://blog.ysf.cc/sap/abap/changerecord.html</id>
    <link href="https://blog.ysf.cc/sap/abap/changerecord.html"/>
    <updated>2025-03-18T04:44:38.000Z</updated>
    <summary type="html"><![CDATA[
<p>当一个对象或者表内容被更改时，查找记录</p>
]]></summary>
    <content type="html"><![CDATA[
<p>当一个对象或者表内容被更改时，查找记录</p>
<!-- more -->
<p>如果一个表启用了变更日志（Change Log）功能，可以在配置的客户端查询SE16N-&gt;Environment → Changes。(如果表中的内容是通过其他客户端通过请求传输而来，这里是没有记录的，可以通过请求的相关表记录查看CDPOS啥的)</p>
<h2>举例</h2>
<p>mmnr物料类型，最近发现物料类型的给码规则被动了，好像编号范围编号组不能传输只能客户端本地配置，后来发现是编号范围组分配给物料类型被传输了。表T134中有物料类型被分配的编号范围组数据，查询用MATERIALNR对象，表名(其实是传输结构)INRG1编号范围的组结构,传到函数模块；INRIV编号范围间隔结构，功能模块的传输；TNRGT数码范围对象组的文本。</p>
<h2>使用事务代码SE16或SE16N查询CDHDR和CDPOS表</h2>
<p>先查看表的技术设置，是否存有日志更改，或者有其他的对象更改记录<br>
</p>
<h2>使用事务代码SE16或SE16N查询E071和E070表或者E071K(E07*)</h2>
<p>查看请求信息</p>
<h2>前台查看更改文档(其实也是CDPOS里的数据好像)</h2>
<h2>参考文献</h2>
]]></content>
    <category term="SAP"/>
    <published>2025-01-20T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">获取附件</title>
    <id>https://blog.ysf.cc/sap/abap/getattachment.html</id>
    <link href="https://blog.ysf.cc/sap/abap/getattachment.html"/>
    <updated>2025-06-30T10:10:44.000Z</updated>
    <summary type="html"><![CDATA[
<ul>
<li>将SAP采购申请上(其他附件同理)的附件传输给外围系统</li>
</ul>
]]></summary>
    <content type="html"><![CDATA[
<ul>
<li>将SAP采购申请上(其他附件同理)的附件传输给外围系统</li>
</ul>
<!-- more -->
<p>将文件转换成二进制再转换成16进制(XSTRING)传输给外围系统</p>
<ul>
<li>
<p>还可以使用FTP服务器</p>
</li>
<li>
<p>还可以让外部系统提供url，SAP进行下载</p>
</li>
</ul>
<h2>过程</h2>
<p>可以在TOJTT表中查找相关对象类型<br>
可以在SRGBTBREL表中查看已存在附件</p>
<p>可以研究一下能否直接使用ODATA(CV_ATTACHMENT还不会用ODATA🐤)</p>
<h2>代码</h2>
<p>自己写了(抄🎧)个公开类-SE24:ABAP类构建器</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">   METHOD</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> GET_PR_ATTACHMENTS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: LV_OBJECT_TYPE      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> DOKOB,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LV_OBJECT_TYPE_LONG </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> OBJECTTYPEID,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LV_SEMANTIC_OBJECT  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> /UI2/SEMANTIC_OBJECT,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LV_OBJECT_KEY       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> OBJKY,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LT_ATTACHMENTS      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TT_ODATA_CV_ATTACH,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LS_ORIGINAL_CONTENT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CL_CV_ATTACHMENT_MPC_EXT=&gt;TS_ORIGINALCONTENT_EXT,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LT_ORIGINAL_CONTENTS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CL_CV_ATTACHMENT_MPC_EXT=&gt;TT_ORIGINALCONTENT_EXT,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LT_GOS_ORIGINAL_CONT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CL_ODATA_CV_BO=&gt;TY_T_ATTACHMENT_CONTENT,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LS_GOS_ORIGINAL_CONT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CL_ODATA_CV_BO=&gt;TY_S_ATTACHMENT_CONTENT,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LX_CV_BASE          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE REF TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CX_ODATA_CV_BASE_EXCEPTION,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LT_RETURN           </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> BAPIRET2_T,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LT_HEADERS          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> TIHTTPNVP,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LO_PERS_SERV        </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE REF TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> IF_ODATA_CV_SERVICE,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LB_ATTACH_PERSIST   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE REF TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> BADI_CV_ODATA_ATTACH_PERSIST,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LS_ODATA_CV_OBJ_MAP </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ODATA_CV_OBJ_MAP.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJ_ID    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SX_OBJ_ID.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_CONTENT   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SX_CONTENT.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_DATA      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE TABLE OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SOLIX.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_DATA2      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE TABLE OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> SOLI.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_FILENAME  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> STRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_PATH      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> STRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_FULLPATH  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> STRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_LEN       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> I</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_ITEM</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ZTWOSTRING.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_FILE_LENGTH</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> I</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_STRING_TABLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> XSTRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_STRING_BSE64</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> STRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_EF_HASHSTRING</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> STRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_STRING</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF"> STRING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**********************************************************************</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    LV_OBJECT_TYPE_LONG </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJECT_TYPE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'BUS2105'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">. </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"Business Object for Purchase Requisition</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    LV_OBJECT_KEY       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> IV_BANFN. </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"Purchase Requisition Number</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**********************************************************************</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    GET</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> BADI</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LB_ATTACH_PERSIST</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      FILTERS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        OBJECT_TYPE     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJECT_TYPE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        SEMANTIC_OBJECT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_SEMANTIC_OBJECT.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LB_ATTACH_PERSIST </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> BOUND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> BADI</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LB_ATTACH_PERSIST-&gt;FINALIZE_OBJECT_KEYS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          IV_OBJECTTYPE          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJECT_TYPE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          IV_OBJECTTYPE_LONG     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJECT_TYPE_LONG</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        CHANGING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          CV_FINALIZED_OBJECTKEY </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJECT_KEY.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**********************************************************************</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    TRY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        LS_ODATA_CV_OBJ_MAP-GOS_OBJTYPE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJECT_TYPE.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        LO_PERS_SERV </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CL_CV_ATTACHMENT_OBJ_FACTORY=&gt;GET_OBJECT_INSTANCE(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                              IV_PERS_OBJECTTYPE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> IF_ODATA_CV_CONSTANTS=&gt;GC_GOS_OBJECT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                              IS_OBJ_MAP         </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_ODATA_CV_OBJ_MAP ).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> METHOD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LO_PERS_SERV-&gt;GET_ATTACHMENT_LIST</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            IV_OBJECTKEY        </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJECT_KEY</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            IV_OBJECTTYPE_LONG  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJECT_TYPE_LONG</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            ET_ORIGINAL_CONTENT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_GOS_ORIGINAL_CONT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            ET_HEADER           </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_HEADERS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            ET_MESSAGES         </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_RETURN.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_RETURN </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INITIAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          MOVE-CORRESPONDING</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> EXACT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_GOS_ORIGINAL_CONT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_ATTACHMENTS.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          LOOP AT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_GOS_ORIGINAL_CONT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_GOS_ORIGINAL_CONT.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            READ TABLE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_ATTACHMENTS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> WITH KEY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> APPLICATION_ID </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_GOS_ORIGINAL_CONT-APPLICATION_ID</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                                               FILE_ID        </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_GOS_ORIGINAL_CONT-FILE_ID</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                                               TRANSPORTING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> NO </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">FIELDS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">  SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &lt;&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              DELETE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_GOS_ORIGINAL_CONT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">USING KEY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LOOP_KEY.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          ENDLOOP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_GOS_ORIGINAL_CONT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> NOT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INITIAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CLEAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_ORIGINAL_CONTENTS.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            LOOP AT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_GOS_ORIGINAL_CONT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_GOS_ORIGINAL_CONT.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              CLEAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_ORIGINAL_CONTENT.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              MOVE-CORRESPONDING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_GOS_ORIGINAL_CONT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_ORIGINAL_CONTENT.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              LS_ORIGINAL_CONTENT-CONTENTTYPE       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_GOS_ORIGINAL_CONT-MIMETYPE.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              LS_ORIGINAL_CONTENT-FULLNAME          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_GOS_ORIGINAL_CONT-CREATEDBY_FULLNAME.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              LS_ORIGINAL_CONTENT-ATTACHMENTSTATUS  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_GOS_ORIGINAL_CONT-ATTACHMENT_STATUS.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              LS_ORIGINAL_CONTENT-CONTENTSOURCE     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_GOS_ORIGINAL_CONT-ATTACHMENT_URL.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              LS_ORIGINAL_CONTENT-SOURCE            </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> IF_ODATA_CV_CONSTANTS=&gt;GC_GOS_OBJECT.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              APPEND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_ORIGINAL_CONTENT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_ORIGINAL_CONTENTS.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            ENDLOOP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      CATCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CX_ODATA_CV_DB_EXCEPTION CX_ODATA_CV_BASE_EXCEPTION </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LX_CV_BASE.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ENDTRY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**********************************************************************</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    LOOP AT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_ORIGINAL_CONTENTS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">ASSIGNING</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FIELD-SYMBOL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">&lt;FILES&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">      "Get file content</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      LV_OBJ_ID </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FILES&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-DOCUMENTNUMBER.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'SO_OBJECT_DATA_FOR_SEND_GET'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          OBJECT_ID            </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_OBJ_ID</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          CONTENT              </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_CONTENT</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          ERR_OBJ_NOT_FOUND    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          ERR_NO_AUTHORIZATION </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          ERR_WRONG_REFERENCE  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">               =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      LT_DATA </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_CONTENT-LINESX.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      LV_LEN  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_CONTENT-LEN.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      "Can download to local</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      CALL METHOD cl_gui_frontend_services=&gt;file_save_dialog</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        CHANGING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          filename             = lv_filename</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          path                 = lv_path</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          fullpath             = lv_fullpath</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          cntl_error           = 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          error_no_gui         = 2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          not_supported_by_gui = 3</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          OTHERS               = 4.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      CALL FUNCTION 'GUI_DOWNLOAD'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          bin_filesize = lv_len</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          filename     = lv_fullpath</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          filetype     = 'BIN'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        TABLES</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          data_tab     = lt_data.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      LV_FILE_LENGTH = LINES( LT_DATA[] ) * 255.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      LV_FILE_LENGTH </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_LEN.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*将二进制数据转换为XSTRING格式</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'SCMS_BINARY_TO_XSTRING'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          INPUT_LENGTH </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_FILE_LENGTH</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          BUFFER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">       =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_STRING_TABLE</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        TABLES</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          BINARY_TAB   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_DATA</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          FAILED</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">       =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">       =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**XSTRING转BASE64</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      CALL FUNCTION 'SCMS_BASE64_ENCODE_STR'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          INPUT  = LV_STRING_TABLE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          OUTPUT = LV_STRING_BSE64.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**将base64进行sha256加密变短点太长了，不太行这个加密好像不能解密</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      TRY.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          CL_ABAP_MESSAGE_DIGEST=&gt;CALCULATE_HASH_FOR_CHAR(</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*            EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*              IF_ALGORITHM = 'SHA256'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*              IF_DATA      = LV_STRING_BSE64</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*            IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*              EF_HASHSTRING = LV_EF_HASHSTRING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          ).</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        CATCH CX_ROOT.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          " Eh, what're you gonna do?</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      ENDTRY.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> AND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_STRING_TABLE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> NOT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INITIAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        GS_ITEM-FILENAME </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FILES&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-FILENAME.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        GS_ITEM-STRING_TABLE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_STRING_TABLE.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        GS_ITEM-STRING_TABLE = LV_EF_HASHSTRING.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        GS_ITEM-STRING_TABLE = LV_STRING_BSE64.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        APPEND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_ITEM</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_ITEM.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**将二进制数据转换为STRING格式</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      CALL FUNCTION 'SCMS_BINARY_TO_STRING'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          INPUT_LENGTH = LV_FILE_LENGTH</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**         FIRST_LINE   = 0</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**         LAST_LINE    = 0</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**         MIMETYPE     = ' '</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**         ENCODING     =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          TEXT_BUFFER  = LV_STRING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**         OUTPUT_LENGTH       =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        TABLES</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          BINARY_TAB   = LT_DATA</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">** EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**         FAILED       = 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**         OTHERS       = 2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        .</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      IF SY-SUBRC = 0 AND LV_STRING IS NOT INITIAL.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        GS_ITEM-FILENAME = &lt;FILES&gt;-FILENAME.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        GS_ITEM-STRING_TABLE = LV_STRING.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        APPEND GS_ITEM TO GT_ITEM.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*      ENDIF.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_CONTENT-LINES[] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> NOT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INITIAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> .  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">".txt?这里好像直接就是文本</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        LT_DATA2 = LS_CONTENT-LINES.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        LV_LEN  = LS_CONTENT-LEN.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        LV_FILE_LENGTH = LINES( LT_DATA2[] ).</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**将二进制数据转换为XSTRING格式</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        CALL FUNCTION 'SCMS_BINARY_TO_XSTRING'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*            INPUT_LENGTH = LV_FILE_LENGTH</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*            BUFFER       = LV_STRING_TABLE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          TABLES</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*            BINARY_TAB   = LT_DATA2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*            FAILED       = 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*            OTHERS       = 2.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        IF SY-SUBRC = 0 AND LV_STRING_TABLE IS NOT INITIAL.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          GS_ITEM-FILENAME = &lt;FILES&gt;-FILENAME.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          GS_ITEM-STRING_TABLE = LV_STRING_TABLE.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          APPEND GS_ITEM TO GT_ITEM.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*        ENDIF.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ENDLOOP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  ENDMETHOD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>参考文献</h2>
<p><a href="https://blog.csdn.net/u010837413/article/details/140277415" target="_blank" rel="noopener noreferrer">运用GOS技术将报文中的附件(PDF.TXT等) 存至系统附件内-Ramos丶</a><br>
<a href="https://blog.csdn.net/m0_74015269/article/details/135543499?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-2-135543499-blog-140277415.235" target="_blank" rel="noopener noreferrer">ABAP - 获取PR采购申请/PO订单等标准对象上的附件（GOS）-14年ABAP码农</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-12-16T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">我觉得好用的语法</title>
    <id>https://blog.ysf.cc/sap/abap/goodgrammar.html</id>
    <link href="https://blog.ysf.cc/sap/abap/goodgrammar.html"/>
    <updated>2025-06-11T07:07:47.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>内容</h2>
<h3>1. 获取字段的值的值</h3>
<p>可以少用点if 😸</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">: LT_FIELDS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE TABLE OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CHAR32,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        LS_FIELD </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> LIKE LINE OF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_FIELDS.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*公司名称及地址</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  SELECT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> SINGLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> *</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> @</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">GS_T001W</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> T001W </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> WERKS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> @ES_HEAD-BUKRS.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ES_HEAD-NAME1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_T001W-NAME1.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*  ES_HEAD-STRAS = GS_T001W-ORT01 &amp;&amp; ` ` &amp;&amp; GS_T001W-REGIO &amp;&amp; ` ` &amp;&amp;  GS_T001W-LAND1.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CLEAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_FIELDS.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  REFRESH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_FIELDS.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  LT_FIELDS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> VALUE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> #(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">( </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'GS_T001W-ORT01'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )   ( </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'GS_T001W-REGIO'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ) ( </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'GS_T001W-LAND1'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ) ).</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*遍历字段数组</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  LOOP AT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_FIELDS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_FIELD.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ASSIGN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (LS_FIELD)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TO</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FLV_SYMBOL&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FLV_SYMBOL&gt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> NOT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INITIAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ES_HEAD-STRAS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INITIAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        ES_HEAD-STRAS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FLV_SYMBOL&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      ELSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FLV_SYMBOL&gt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'US'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          ES_HEAD-STRAS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ES_HEAD-STRAS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">&amp;&amp;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ` `</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'UNITED STATES'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        ELSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          ES_HEAD-STRAS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ES_HEAD-STRAS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">&amp;&amp;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ` `</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">&amp;&amp; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">&lt;FLV_SYMBOL&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  ENDLOOP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>2. 分组处理LOOP GROUP取代at end of啥的</h3>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  SORT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_DATA1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">BY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> RCNTR RACCT.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    LOOP AT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_DATA1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">GS_DATA1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      GROUP</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> BY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ( RCNTR </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_DATA1-RCNTR RACCT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_DATA1-RACCT ).</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"按括号里的条件进行分组</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      GS_ITEM </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> CORRESPONDING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> #( GS_DATA1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                       EXCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> HSL</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                       ).</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      LOOP AT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> GROUP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_DATA1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">MEMBER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"按分组后进行组员的访问</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*    GS_DATA1-HSL = P_MENGE + MEMBER-WKURS."这里就是对同一组的进行某个字段的汇总</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        GS_ITEM-HSL </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_ITEM-HSL </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> MEMBER-HSL.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      ENDLOOP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      APPEND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_ITEM</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_ITEM1[].</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ENDLOOP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>3. 前导0，OUT转换为外围,IN转换为SAP</h3>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">LS_G_AFP-AUFNR </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> |{ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">LS_G_AFP-AUFNR ALPHA = OUT</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> }|</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3>4. 赋值内表/工作区</h3>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  LT_E_MAILDATANONADDRESS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> VALUE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> #( (</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      STD_NO    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'X'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">                        "表中的部分字段</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      E_MAIL    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> PS_ALV-SMTP_ADDR2 ) ).     </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"独立通讯E-mail</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  R_RACCT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> VALUE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> #( </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">SIGN</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'I'</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> OPTION</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'EQ'</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ( LOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '6601010600'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ( LOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '6601010700'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ( LOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '6601010800'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ( LOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '6601010900'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ( LOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '6601011000'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ( LOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '6601510000'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  ( LOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '6601520000'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> )</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ).</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    GS_DATA </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> CORRESPONDING</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> #( GS_OUT2</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                     MAPPING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                     TEXT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> = TYPE</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                     EXCEPT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> REPVAL</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                     ZBS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                     ).</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*结构相同的两个内表，在原有内表内容的基础上添加新表内容</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  LOOP AT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_OUT2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">GS_DA3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    GS_DA3-REP </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_I .</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    GT_OUT3[] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> VALUE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> #( </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">BASE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_OUT3[]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                       ( GS_DA3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                         ) ).</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  ENDLOOP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    LOOP AT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_COL </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">ASSIGNING</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FIELD-SYMBOL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">&lt;FS_COL&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      READ TABLE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_DATA </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_DATA</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> WITH KEY</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TEXT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FS_COL&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-TEXT TEXT2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FS_COL&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-TEXT2.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        LV_I </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*将结构里某个字段名的字段的值赋值给指针</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        ASSIGN</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> COMPONENT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_I</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> OF STRUCTURE</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> &lt;FS_COL&gt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TO</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FIELD-SYMBOL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">&lt;FS_REP&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">        &lt;FS_REP&gt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_DATA-REPVAL.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    ENDLOOP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>5. 能将程序中的内表和工作区传递给另一个程序还是啥？</h3>
<p>这是我看到的一个smartforms的应用方式，实际我还没操作过<br>
</p>
<h3>6. API消息输出？没用过不知道</h3>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*API环境初始化</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CALO_INIT_API'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      FLAG_DB_LOG_ON           </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'X'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">      "Database Logging On</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      FLAG_MSG_ON              </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'X'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">      "Transfer Messages to Internal Tables</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      FLAG_API_API_CALL_ON     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ''</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">      "API Called by API -&gt; Collect Messages</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      FLAG_COLLECT_MSG_ON      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ''</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">      "Collect Messages and Output via FM CALO...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      EXTERNAL_LOG_NO          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'API'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    "External Log Number (See Transaction SLG1)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      DEL_LOG_AFTER_DAYS       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '10'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">     "DB Log Will Be Deleted After * Days</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      DATA_RESET_SIGN          </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '!'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">      "Initial Value</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      LOG_OBJECT_NOT_FOUND     </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      LOG_SUB_OBJECT_NOT_FOUND </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                   =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">**这里正常的调用function，bapi，函数啥的好像是一个东西吧</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*在CAPI日志中输入收集的消息</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CALO_MSG_APPEND_DB_LOG'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      LOG_OBJECT_NOT_FOUND    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      LOG_SUBOBJECT_NOT_FOUND </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      LOG_INTERNAL_ERROR      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                  =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*Read Messages from Current Log Entry</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'CALO_LOG_READ_MESSAGES'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      LANGUAGE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">LANGU</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    TABLES</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      MESSAGES_AND_PARAMETERS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_MESSAGES</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      WARNING                 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">      ERROR                   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                  =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  SELECT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> *</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FROM</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">     @LT_MESSAGES </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">AS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> MSG_TYPE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'A'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    OR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> MSG_TYPE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'E'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> @</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">WA_MESSAGES1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  ENDSELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>7. 查询ABAP代码的标准工具</h3>
<p>程序RS_ABAP_SOURCE_SCAN</p>
<p>后台进程想打断点可以先输入/H然后设置更新调试<br>
</p>
<h3>8. ALV的fieldcat自动生成</h3>
<p>根据结构或者内表</p>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'LVC_FIELDCATALOG_MERGE'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   I_BUFFER_ACTIVE              =</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">   I_STRUCTURE_NAME             </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'KAEP_COAC'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   I_CLIENT_NEVER_DISPLAY       = 'X'</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   I_BYPASSING_BUFFER           =</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   I_INTERNAL_TABNAME           =</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  CHANGING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    CT_FIELDCAT                  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> FIELDCAT[]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">* EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   INCONSISTENT_INTERFACE       = 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   PROGRAM_ERROR                = 2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*   OTHERS                       = 3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          .</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>参考文献</h2>
<p>感谢我大慈大悲的猫哥提供的帮助</p>
<!-- D:\Documents\code\MyGitee\blog-source-main\src\.vuepress\public\file\abap新语法.docx 好像生成dist html文件时可能通过配置直接在D:\Documents\code\MyGitee\blog-source-main\dist\file里了-->
<p><a href="/file/abap%E6%96%B0%E8%AF%AD%E6%B3%95.docx" title="下载文档">下载abap新语法文档</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-12-11T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">怎么个事</title>
    <id>https://blog.ysf.cc/informalessay/tattle/emotion.html</id>
    <link href="https://blog.ysf.cc/informalessay/tattle/emotion.html"/>
    <updated>2024-12-06T08:34:14.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>过程总结</h2>
<p>最近一直在搞发邮件，感觉延伸了好多东西。<br>
一开始是配置邮件功能，配了很久，之后还经历邮箱迁移。<br>
自己研究了利用CL_BCS类，自开发程序进行邮件发送，由SMARTFORMS，OTF to PDF再转换二进制。<br>
用户要使用标准功能，又研究了消息类型，对应的配置啥的。<br>
不知道标准邮件功能咋改成自己想要的附件以为标准的pdf是adobe form生成的，去了解了一下，因为布局打不开下载了打了GUI<a href="https://drive.google.com/file/d/12FLhyQX-kiBYf2mAxfuuh0eT0IJBDlMk/view?pli=1" target="_blank" rel="noopener noreferrer">1121176补丁</a>。<br>
但还是不行，没有配置对应服务器连接。无效 HTTP 连接：ADS。调用包含错误: ADS (2)。<br>
太难了😭</p>
<p>嘿嘿搞好了 🏃</p>
<h2>参考资料</h2>
<!-- <Share /> -->]]></content>
    <category term="随笔"/>
    <published>2024-12-02T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">CDS(Core data services核心数据服务)</title>
    <id>https://blog.ysf.cc/sap/abap/cds.html</id>
    <link href="https://blog.ysf.cc/sap/abap/cds.html"/>
    <updated>2024-12-03T06:39:46.000Z</updated>
    <summary type="html"><![CDATA[
<p><a href="https://www.zapyard.com/tutorials-on-core-data-services-cds/" target="_blank" rel="noopener noreferrer">https://www.zapyard.com/tutorials-on-core-data-services-cds/</a><br>
核心数据服务是一种新的基础设施，用于在 SAP HANA 中定义和使用语义丰富的数据模型。</p>
]]></summary>
    <content type="html"><![CDATA[
<p><a href="https://www.zapyard.com/tutorials-on-core-data-services-cds/" target="_blank" rel="noopener noreferrer">https://www.zapyard.com/tutorials-on-core-data-services-cds/</a><br>
核心数据服务是一种新的基础设施，用于在 SAP HANA 中定义和使用语义丰富的数据模型。</p>
<!-- more -->
<p>使用数据定义语言 （DDL）、查询语言 （QL） 和表达式语言 （EL），CDS 被设想为包含写入操作、事务语义、约束等。<br>
CDS AMDP OpenSQL ODATA服务</p>
<ul>
<li>SQL</li>
<li>Open SQL</li>
<li>CDS</li>
</ul>
<h2>简述</h2>
<p>CDS分为ABAP CDS和HANA CDS两种类型。</p>
<figure><figcaption>alt text</figcaption></figure>
<h2>事物代码</h2>
<h2>参考文献</h2>
<!-- <!-- [PO 发布外围系统REST-＞SAP RFC同步接口-Seele_1018](https://blog.csdn.net/qq_44826887/article/details/134922069) -->
<p><a href="https://www.cnblogs.com/joeg/p/17722641.html" target="_blank" rel="noopener noreferrer">SAP Abap三种方法进行SAP ODATA数据服务发布</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-11-18T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">FIORI</title>
    <id>https://blog.ysf.cc/sap/abap/fioribeginner.html</id>
    <link href="https://blog.ysf.cc/sap/abap/fioribeginner.html"/>
    <updated>2024-12-03T06:39:46.000Z</updated>
    <summary type="html"><![CDATA[
<p><a href="https://www.zapyard.com/tutorials-on-sap-fiori/" target="_blank" rel="noopener noreferrer">(https://www.zapyard.com/tutorials-on-sap-fiori/)</a></p>
]]></summary>
    <content type="html"><![CDATA[
<p><a href="https://www.zapyard.com/tutorials-on-sap-fiori/" target="_blank" rel="noopener noreferrer">(https://www.zapyard.com/tutorials-on-sap-fiori/)</a></p>
<!-- more -->
<h2>事物代码</h2>
<h2>参考文献</h2>
<!-- [PO 发布外围系统REST-＞SAP RFC同步接口-Seele_1018](https://blog.csdn.net/qq_44826887/article/details/134922069)
[PO 发布SAP SProxy-＞外围系统 WebService-Seele_1018](https://blog.csdn.net/qq_44826887/article/details/135170299) -->]]></content>
    <category term="SAP"/>
    <published>2024-11-18T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">ODATA</title>
    <id>https://blog.ysf.cc/sap/abap/odatabeginner.html</id>
    <link href="https://blog.ysf.cc/sap/abap/odatabeginner.html"/>
    <updated>2024-12-03T06:39:46.000Z</updated>
    <summary type="html"><![CDATA[
<p>OData（Open Data Protocol）是一种基于REST的数据访问协议，用于设计和使用RESTful API。<br>
<a href="https://www.zapyard.com/tutorials-on-odata-sap-netweaver-gateway/" target="_blank" rel="noopener noreferrer">https://www.zapyard.com/tutorials-on-odata-sap-netweaver-gateway/</a></p>
]]></summary>
    <content type="html"><![CDATA[
<p>OData（Open Data Protocol）是一种基于REST的数据访问协议，用于设计和使用RESTful API。<br>
<a href="https://www.zapyard.com/tutorials-on-odata-sap-netweaver-gateway/" target="_blank" rel="noopener noreferrer">https://www.zapyard.com/tutorials-on-odata-sap-netweaver-gateway/</a></p>
<!-- more -->
<h2>发布SAP ODATA数据服务的三种方式</h2>
<ul>
<li>通过DDIC发布ODATA服务</li>
<li>通过RFC发布ODATA服务</li>
<li>通过CDS发布ODATA服务</li>
</ul>
<h2>事物代码</h2>
<table>
  <tbody><tr>
    <td style="text-align: left; width: 50%;">/IWFND/EXPLORER</td>
    <td style="text-align: left; width: 50%;">服务探索器，用于查看可用的服务</td>
  </tr>
  <tr>
    <td style="text-align: left; width: 50%;">/IWFND/SERVICE_TEST</td>
    <td style="text-align: left; width: 50%;">服务测试，可能用于测试服务的功能性</td>
  </tr>
    <tr>
    <td style="text-align: left; width: 50%;">/IWFND/VIEW_LOG</td>
    <td style="text-align: left; width: 50%;">网关应用日志查看器，用于查看相关的日志信息</td>
  </tr>
    <tr>
    <td style="text-align: left; width: 50%;">/IWFND/GW_CLIENT</td>
    <td style="text-align: left; width: 50%;">SAP Gateway 客户端</td>
  </tr>
</tbody></table>
<h2>参考文献</h2>
<p><a href="https://it.cha138.com/java/show-4010617.html#2RFCODATA_96" target="_blank" rel="noopener noreferrer">SAP Abap三种方法进行SAP ODATA数据服务发布（DDICRFCCDS）</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-11-21T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">常见英文缩写全名</title>
    <id>https://blog.ysf.cc/sap/abap/commonenglishabbreviations.html</id>
    <link href="https://blog.ysf.cc/sap/abap/commonenglishabbreviations.html"/>
    <updated>2024-12-03T06:39:46.000Z</updated>
    <summary type="html"><![CDATA[
<p>常见英文缩写全名</p>
]]></summary>
    <content type="html"><![CDATA[
<p>常见英文缩写全名</p>
<!-- more -->
<h2>内容</h2>
<ul>
<li>DDIC （Data Dictionary） 数据字典。DDIC提供了一个图形用户界面（SE11）</li>
<li>OData（Open Data Protocol）是一种基于REST的数据访问协议，用于设计和使用RESTful API。</li>
</ul>
<h2>参考文献</h2>
<!-- [PO 发布外围系统REST-＞SAP RFC同步接口-Seele_1018](https://blog.csdn.net/qq_44826887/article/details/134922069) -->
]]></content>
    <category term="SAP"/>
    <published>2024-11-21T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">SMARTFORMS</title>
    <id>https://blog.ysf.cc/sap/abap/smartfoems.html</id>
    <link href="https://blog.ysf.cc/sap/abap/smartfoems.html"/>
    <updated>2024-12-03T06:39:46.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<p>我自己理解他也是一个接口有输入输出，然后就是画图调下位置。<br>
货币和数量字段需要在SMARTFORMS里声明类型。</p>
<h2>内容</h2>
<p><a href="https://blog.csdn.net/wuzhong369/article/details/101677020" target="_blank" rel="noopener noreferrer">上传LOGO，SE78</a><br>
标准SMARTFOEMS结构-SFSY，可输出页码等<br>
</p>
<h2>参考文献</h2>
<p><a href="https://blog.csdn.net/wuzhong369/article/details/101677020" target="_blank" rel="noopener noreferrer">SAP上传图片LOGO(SE78/SMW0)</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-11-25T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">处理FTP文件的JavaJar脚本</title>
    <id>https://blog.ysf.cc/sap/abap/javajar.html</id>
    <link href="https://blog.ysf.cc/sap/abap/javajar.html"/>
    <updated>2024-11-18T01:52:30.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>接口路径</h2>
<p>一个从AGILE触发，上传文件到FTP服务器，通过一个java的jar的脚本，定时解压缩文件到特定的文件夹，通过PO接收后删除该文件，PO接口通过代理在SAP，由SAP创建物料和BOM。</p>
<p>因为测试环境和开发环境取的是一个FTP服务器的同一个文件夹里的数据，所以测试数据有时会到测试环境有时会到开发环境，故我在测试环境FTP服务器上新建了文件夹把测试和开发文件夹区分了。通过IDEA软件的Jar Editor修改了操作FTP服务器解压缩的java jar脚本。<br>
<br>
<br>
</p>
<p>有时候数据进入到SAP也不出发接口，是因为分配的随机队列，在SMQ2中卡住了（先前的进程有卡住）。</p>
<h2>代码功能</h2>
<p>这段Java代码是一个用于处理FTP文件上传和删除的程序。它使用了Apache Commons Net库来处理FTP连接和文件传输。下面是对代码主要功能的解释：</p>
<ol>
<li>FTP连接：<br>
FTPUtils.getFTPClient方法用于创建一个FTP客户端连接到指定的FTP服务器。</li>
<li>上传文件：<br>
upload方法首先检查本地的两个临时文件夹是否存在，如果不存在则创建它们。<br>
然后，它使用FTPUtils.FTPdownDir方法从FTP服务器下载指定路径下的文件到本地的C:\AXMLtemp目录。<br>
下载的文件是ZIP格式的，程序会遍历这些ZIP文件，如果是.AXML文件，它会解压并将其中的文件保存到C:\XMLtemp目录。<br>
解压后的.xml文件会通过FTPUtils.uploadFile方法上传到FTP服务器的指定路径。</li>
<li>删除FTP文件：<br>
deleteFtpFile方法用于删除FTP服务器上指定路径下的所有.AXML和.XML文件。<br>
它首先列出当前工作目录下的所有文件，然后检查文件名是否包含.AXML或.XML，如果是，则删除这些文件。</li>
<li>删除本地文件：<br>
deleteFile方法用于递归删除指定目录下的所有文件和子目录。<br>
辅助方法：<br>
newFile方法用于创建一个新的文件，同时检查该文件是否在目标目录下，以防止路径遍历攻击。<br>
FTPUtils.FTPClose方法用于关闭FTP连接。</li>
<li>主方法：<br>
main方法是程序的入口点，它调用upload方法上传三个不同路径下的文件，然后调用deleteFtpFile方法删除根目录下的所有.AXML和.XML文件。<br>
整体来看，这个程序的主要功能是管理FTP服务器上的文件，包括上传和删除特定类型的文件。它还处理了本地文件的创建和删除，以及ZIP文件的解压和内容的处理。</li>
</ol>
<h2>java jar 代码</h2>
<div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">//</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// Source code recreated from a .class file by IntelliJ IDEA</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// (powered by FernFlower decompiler)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">package</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD"> com.wx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.io.File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.io.FileInputStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.io.FileOutputStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.io.IOException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.nio.charset.StandardCharsets</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.util.zip.ZipEntry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> java.util.zip.ZipInputStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> org.apache.commons.net.ftp.FTPClient</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> org.apache.commons.net.ftp.FTPFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> Main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> ftpPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/Agile"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        upload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ftpPath);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        ftpPath </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/AgileBom500"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        upload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ftpPath);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        ftpPath </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/AgileMat500"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        upload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ftpPath);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        ftpPath </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/AgileBom"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        upload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ftpPath);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        ftpPath </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "/AgileMat"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        upload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ftpPath);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">        deleteFtpFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"/"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> deleteFtpFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> pathName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        FTPClient</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> ftpClient</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> FTPUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getFTPClient</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"服务器地址"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, 端口号, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"账号"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"密码"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        ftpClient</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">enterLocalPassiveMode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        FTPFile</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">files</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> FTPFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            ftpClient</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">changeWorkingDirectory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">pathName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getBytes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(), </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">StandardCharsets</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">ISO_8859_1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            files </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> ftpClient</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">listFiles</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">IOException</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> var10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            IOException</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> var9</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var10;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            IOException</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var9;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(e);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        FTPFile</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">var10</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> files;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> var4</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> var5</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; var5 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var4; ++var5) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            FTPFile</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var10[var5];</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">isFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&amp;&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">contains</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">".AXML"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">||</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">contains</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">".XML"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">))) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                    ftpClient</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">deleteFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">IOException</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> var9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">                    IOException</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> var8</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var9;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">                    IOException</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var8;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                    throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(e);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        FTPUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">FTPClose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ftpClient);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> upload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">String</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> ftpPath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> file1</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"C:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">AXMLtemp"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">file1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">exists</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            file1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mkdirs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> file2</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"C:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">XMLtemp"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">file2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">exists</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            file2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">mkdirs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        FTPClient</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> ftpClient</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> FTPUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getFTPClient</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"******"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">21</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"******"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"******"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        FTPUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">FTPdownDir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ftpClient, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"C:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">AXMLtemp"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"//"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">60</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> path</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "C:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">AXMLtemp"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(path);</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        File</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">fs</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">listFiles</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> fileZip</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#C678DD">        byte</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">buffer</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD"> byte</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1024</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">];</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> str2</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ""</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            File</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">var20</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> fs;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> var12</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> fs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> var13</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; var13 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var12; ++var13) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">                File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> f</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var20[var13];</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">isDirectory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                    fileZip </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">valueOf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(f);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">fileZip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">contains</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">".AXML"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">                    ZipInputStream</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> zis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> ZipInputStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> FileInputStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(fileZip));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">ZipEntry</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> zipEntry</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> zis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getNextEntry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(); zipEntry </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; zipEntry </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> zis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getNextEntry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                        str2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                        str </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "C:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">XMLtemp</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> str2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">substring</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">str2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">indexOf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ".xml"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">                        FileOutputStream</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> fos</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> FileOutputStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(str);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                        int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                        while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">((len </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> zis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">read</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(buffer)) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                            fos</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(buffer, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, len);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                        fos</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">close</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                    zis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">closeEntry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                    zis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">close</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">                    FileInputStream</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> FileInputStream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(str));</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                    FTPUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">uploadFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ftpPath, ftpClient, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">str2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">substring</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">str2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">indexOf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"."</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> ".xml"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, in);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                    System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(str);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">IOException</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> var19</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            IOException</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> var19</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var19;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            IOException</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> e</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var19;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">printStackTrace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">        FTPUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">FTPClose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(ftpClient);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">deleteFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(file1)) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"AXML缓存文件删除成功！"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">deleteFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(file2)) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"XML缓存文件删除成功！"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> File</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> newFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">File</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> destinationDir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">ZipEntry</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> zipEntry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> throws</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> IOException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> destFile</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(destinationDir, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">zipEntry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> destDirPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> destinationDir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getCanonicalPath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">        String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> destFilePath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> destFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getCanonicalPath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">destFilePath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">startsWith</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(destDirPath </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">separator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> IOException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"Entry is outside of the target dir: "</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> zipEntry</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">getName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">());</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> destFile;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> static</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B"> Boolean</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> deleteFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">File</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (file </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> &amp;&amp;</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">exists</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            File</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">files</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">listFiles</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">            File</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF">[] </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">var2</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> files;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> var3</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> var4</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">; var4 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var3; ++var4) {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B">                File</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> f</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> var2[var4];</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">isDirectory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()) {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">                    deleteFile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(f);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">                    f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">delete</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">delete</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">();</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">            System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"文件删除失败,请检查文件是否存在以及文件路径是否正确"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>参考资料</h2>
<p><a href="https://www.exception.site/article/1777" target="_blank" rel="noopener noreferrer">IDEA</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-11-08T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">PO接口类型</title>
    <id>https://blog.ysf.cc/sap/abap/pointerfacetype.html</id>
    <link href="https://blog.ysf.cc/sap/abap/pointerfacetype.html"/>
    <updated>2025-07-16T02:44:30.000Z</updated>
    <summary type="html"><![CDATA[
<p>记录一下自己碰到过的PO接口类型及怎样配置与传输顺序。在其他东西已经由basis配置好的情况下。<br>
JDBC/SOAP/RFC/SOAP/REST</p>
]]></summary>
    <content type="html"><![CDATA[
<p>记录一下自己碰到过的PO接口类型及怎样配置与传输顺序。在其他东西已经由basis配置好的情况下。<br>
JDBC/SOAP/RFC/SOAP/REST</p>
<!-- more -->
<h2>外部系统调用SAP-RFC</h2>
<ul>
<li>先在SAP写好RFC接口</li>
<li>PO-ESR(一般正式PO都是传输)
<ul>
<li>在对应的软件组件里导入SAP的函数模块</li>
<li>我是一个命名空间一个接口，在软件组件下面创建命名空间</li>
<li>在命名空间下面分别创建SI(RFC Message),MM-REQ,MM-RES,OM(SI外部系统-&gt;SAP;MM;SAP函数接口)</li>
</ul>
</li>
<li>PO-ID(通道的参数有些需要正式和测试环境不同，可以修改或者传输)
<ul>
<li>Business Compponent下外部系统CC-SOAP通道，Business System下SAP CC SOAP 接收通道(需要不同的接口创建人可以创建多个CC因为是使用账号验证的账号)</li>
<li>创建IC</li>
</ul>
</li>
<li>根据IC的WSDL，去测试软件SOAPUI测试(POSTMAN也可以比较麻烦，POST需要里面的地址)</li>
<li>编写开发说明书</li>
<li>传输时要先传SAP的函数请求，再传输PO-ESR导入的函数和其他的SI,MM,OM,然后是PO-ID:CC,IC<br>
<br>
<br>
<br>
<br>
</li>
</ul>
<h2>SAP调用外部系统-代理</h2>
<ul>
<li>
<p>PO-ESR</p>
<ul>
<li>由外部系统提供WSDL(ED),ED导入PO</li>
<li>创建外部系统SI-IN，和SAP的SI-OUT(RFC Message使用上述ED里的方法)</li>
<li>分别创建MM-REQ,MM-RES,OM(SAP的SI-OUT;MM;外部系统SI-IN)</li>
</ul>
</li>
<li>
<p>PO-ID</p>
<ul>
<li>创建Business System下SAP CC:CC_SAP_PROXY_SEND</li>
<li>创建Business Compponent下外部系统 CC:CC_外部系统_SOAP_RECV</li>
<li>创建IC</li>
</ul>
</li>
<li>
<p>SAP</p>
<ul>
<li>在SAP事务代码SPROXY里ESR浏览器的SAP的SI-OUT生成代理</li>
<li>在函数模块或者增强里调用代理</li>
</ul>
</li>
<li>
<p>传输时要先传PO，再传输SAP</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
</li>
</ul>
<h2>外部系统调用SAP-JDBC数据库处理</h2>
<p>直接处理数据库，设置定时任务处理数据库数据库-&gt;SAP，再更新数据库数据</p>
<ul>
<li>PO-ESR
<ul>
<li>根据交互字段创建Data Types</li>
<li>导入Data Types生成Message Types</li>
<li>创建外部系统SI-OUT，和SAP的SI-IN(使用上述Message Type)</li>
<li>分别创建MM-REQ,MM-RES(使用上述Message Type),OM(外部系统SI-OUT;MM;SAP的SI-IN)</li>
</ul>
</li>
<li>PO-ID
<ul>
<li>创建Business System下SAP CC:CC_SAP_PROXY_RECV</li>
<li>创建Business Compponent下外部系统 CC:CC_外部系统_JDBC_SEND</li>
<li>创建IC</li>
</ul>
</li>
<li>SAP
<ul>
<li>在SAP事务代码SPROXY里ESR浏览器的SAP的SI-IN生成代理</li>
<li>在函数模块或者增强里调用代理</li>
</ul>
</li>
<li>传输时要先传PO，再传输SAP<br>
<br>
<br>
<br>
</li>
</ul>
<h2>外部系统调用SAP-aglie</h2>
<p>其他和外部系统调用SAP-RFC差不多,用RFC作为接收的改用自己用ED(XML文档)生成的SAP_SI-IN,MM也用ED里的</p>
<p>这里是SAP生成的代理接收外围系统传输过来的数据<br>
<br>
</p>
<p>这里是SAP生成的代理调用外部接口传输数据<br>
<br>
<br>
</p>
<h2>连接FTP服务器</h2>
<h2>参考文献</h2>
<p><a href="https://blog.csdn.net/qq_44826887/article/details/134922069" target="_blank" rel="noopener noreferrer">PO 发布外围系统REST-＞SAP RFC同步接口-Seele_1018</a><br>
<a href="https://blog.csdn.net/qq_44826887/article/details/135170299" target="_blank" rel="noopener noreferrer">PO 发布SAP SProxy-＞外围系统 WebService-Seele_1018</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-11-14T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">邮件</title>
    <id>https://blog.ysf.cc/sap/abap/mail.html</id>
    <link href="https://blog.ysf.cc/sap/abap/mail.html"/>
    <updated>2025-06-16T08:43:48.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<p>邮件邮件</p>
<h2>导入步骤</h2>
<p><a href="https://blog.csdn.net/woniu_maggie/article/details/141561991" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/woniu_maggie/article/details/141561991</a></p>
<h2>遇到的问题</h2>
<h3>1. 因为网络问题导致一直出现连接SMTP节点连接不上</h3>
<p>邮箱地址用户端网页可以登录，但sap就是连接不上，首先确认url和端口是否正确，然后确认用户是否正常密码是否修改。url可以ping通， 加上端口就不行，最后确定是网络的策略使端口不通。<br>
用户是前端进的，sap连是后端连的，方式不一样<br>
</p>
<h3><a class="header-anchor" href="#_2-最近进行邮箱地址的迁移改成了qq邮箱-mail-com-smtp-exmail-qq-com-不知道为啥smtp-exmail-qq-com-25端口成功-465端口-ssl-加密端口就不行"><span>2. 最近进行邮箱地址的迁移改成了QQ邮箱(mail.***.com-&gt;</span></a><a href="http://smtp.exmail.qq.com" target="_blank" rel="noopener noreferrer">smtp.exmail.qq.com</a>)，<a href="http://xn--smtp-fb5fjjv27byi1eg73b.exmail.qq.com" target="_blank" rel="noopener noreferrer">不知道为啥smtp.exmail.qq.com</a> 25端口成功，465端口(SSL)加密端口就不行</h3>
<figure><figcaption>alt text</figcaption></figure>
<h3>3. 501 mail from address must be same as authorization user</h3>
<p>发送邮件的用户的电子邮件地址(标准号码)设置必须和节点地址相同，当然用户电子邮件地址可以维护多个</p>
<h3>4. 用户想使用标准消息类型发送邮件，因为nace标准的是通过script，现在通过smartforms行不通，他们使用的是OPEN_FORM函数。ADOBE FORM应该可以但是这里没有启用所以没有测试过</h3>
<p>使用标准的消息类型需要复制SAPFM06P，然后改写其中的ENTRY_NEU子例程，打印和发送均需重新改写</p>
<h3>5. 通过地址号码和人员编号等获取邮箱地址</h3>
<p>用户通信电子邮件地址:USR21-&gt;ADR6;BP通信E-MAIL:BUT020-&gt;ADR6;BP独立地址通信电子邮件:BUT000-&gt;ADR6</p>
<h3>6. 设置定时任务来发送请求</h3>
<figure><figcaption>alt text</figcaption></figure>
<h3>7. 发送邮件，很长时间都不成功，有成功有失败。</h3>
<p><br>
XS756(连接错误导致消息当前无法传输到节点 &amp;)-&gt;XS718(收件人 *** @ **.us 有效。已尝试发送)<br>
XS756(连接错误导致消息当前无法传输到节点 &amp;)-&gt;XS612(当前没有到 *** @ **.us 的投递)<br>
把重复发送尝试过程的最长等待时间设长一点，多次重发就会有成功<br>
可以用hmailserver重新搭建一套测试</p>
<p>可能原因:单纯网络问题、域名解析、路由、防火墙<br>
简单点的做法，在服务器上先按照匿名方式试一下，第一步，<br>
telnet <a href="http://smtp.exmail.qq.com" target="_blank" rel="noopener noreferrer">smtp.exmail.qq.com</a> 25<br>
如果SAP服务器对SMTP服务器域名解析、路由都正确的话，你首先是能收到服务器的响应的，这个是最基本的。服务器能连接的话，就可以试试用你们公司的邮箱做测试了，<a href="http://xn--mysap-mn1hnvh2f55fsq8cpi2hd5e11r.com" target="_blank" rel="noopener noreferrer">我这里随便写了个mysap.com</a><br>
<br>
<br>
在SAP服务器上先执行一下 <a href="http://smpt.exmail.qq.com" target="_blank" rel="noopener noreferrer">smpt.exmail.qq.com</a> 25端口的测试，看看能否连通。SAP里面发邮件，其实挺简单的，它类似于你在服务器上用telnet命令行一样的过程。一般我的做法是服务器上telnet通了就算通了。<br>
To test SMTP authentication via telnet:<br>
In a telnet client such as PuTTY, connect to the SMG appliance:</p>
<p>telnet &lt;SMG_IP_address&gt;  587</p>
<p>Greet the mail server:</p>
<p>EHLO <a href="http://mailserver.com" target="_blank" rel="noopener noreferrer">mailserver.com</a></p>
<p>Tell SMG you want to authenticate with it:</p>
<p>AUTH LOGIN</p>
<p>The server should return the following, which is a base64 encoded string that requires your username:</p>
<p>334 VXNlcm5hbWU6</p>
<p>Paste the base64 encoded username. For example:</p>
<p>dXNlcm5hbWUuY29t</p>
<p>The server should return the following, which is a base64 encoded string that requires your password:</p>
<p>334 UGFzc3dvcmQ6</p>
<p>Paste the base64 encoded password for the username. For example:</p>
<p>bXlwYXNzd29yZ$4<br>
Note: If you receive an error from this point forward, double-check the password and encoding.</p>
<p>Additional information<br>
If you need to manually convert the username and password, search online for a base64 encode and decode tool.</p>
<p>mail from:<a href="mailto:mymail@my.com" target="_blank" rel="noopener noreferrer">mymail@my.com</a><br>
rcpt to:<a href="mailto:rec1@cust1.com" target="_blank" rel="noopener noreferrer">rec1@cust1.com</a><br>
rcpt to:<a href="mailto:rec2@cust2.com" target="_blank" rel="noopener noreferrer">rec2@cust2.com</a><br>
data<br>
from:老猫<a href="mailto:mymail@my.com" target="_blank" rel="noopener noreferrer">mymail@my.com</a><br>
to:金主一号<a href="mailto:rec1@cust1.com" target="_blank" rel="noopener noreferrer">rec1@cust1.com</a>;金主二号<a href="mailto:ec2@cust2.com" target="_blank" rel="noopener noreferrer">ec2@cust2.com</a>;<br>
subject:Test via telnet</p>
<p>This is a test mail via telnet. Wish you good luck.</p>
<p>.<br>
解决方法:</p>
<ol>
<li>把SAP的服务器IP加个白名单。</li>
</ol>
<p>之前可能成功的原因：</p>
<ol>
<li>公司的防火墙能力看来有所不足，估计扛不了多少DDOS负荷，流量多的话会有漏网之鱼。</li>
<li>可能是对某些流量拦截，不是直接阻断所有(最简单是ips上抓包看看)<br>
</li>
</ol>
<h2>事务代码</h2>
<p>SICF<br>
SPROXY<br>
SMICM<br>
RZ10<br>
SBWP<br>
SCOT<br>
SOST<br>
SE78<br>
SMARTFORMS<br>
SE71      SAPscript 格式<br>
SFP       表格构建器(adobe)<br>
NACE      WFMC：初始定制屏幕<br>
ME9F      消息输出: 采购订单</p>
<h2>ABAP测试程序</h2>
<!-- <details>
  <summary>点击展开/折叠代码</summary>
  ```javascript
  console.log("这是一个可折叠的代码块");
  console.log("这是一个可折叠的代码块");
  console.log("这是一个可折叠的代码块");
  console.log("这是一个可折叠的代码块");
   ```
  </details>  -->
<h3>SMARTFORMS获取pdf发送邮件</h3>
<!-- <details>
  <summary>点击展开/折叠代码:SMARTFORMS获取pdf发送邮件</summary> -->
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*&amp;</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div>]]></content>
    <category term="SAP"/>
    <published>2024-10-17T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">网站SSL证书导入SAP</title>
    <id>https://blog.ysf.cc/sap/abap/certificate.html</id>
    <link href="https://blog.ysf.cc/sap/abap/certificate.html"/>
    <updated>2025-06-11T07:07:47.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<p>https地址协议需要证书，http不要<br>
返回500，有可能是网络不好，也有可能是SSL加密证书没有导入SAP，导入下</p>
<!-- <VidStack
  src="../../.vuepress/public/medium/SSL证书导入.mp4"
  poster="https://files.vidstack.io/sprite-fight/poster.webp"
/> -->
<h2>导入步骤</h2>
<p>导入是每个系统单独进行的，不是通过请求传输的</p>
<ul>
<li>准备一下证书(向对方索要，或者自己去下我不会下问对方要的)</li>
<li>事物代码STRUST</li>
</ul>
<p>SE38-&gt;执行报告 SSF_ALERT_CERTEXPIRE 可以查看哪些证书即将到期、设置或关闭证书有效期检查<br>
<br>
</p>
<h2>参考资料</h2>
<p><a href="https://blog.csdn.net/weixin_42400703/article/details/136227495" target="_blank" rel="noopener noreferrer">【SAP-BASIS】接口证书过期，通过STRUST导入</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-09-20T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">上PO的RFC接口生成Webservice</title>
    <id>https://blog.ysf.cc/sap/abap/ynkj.html</id>
    <link href="https://blog.ysf.cc/sap/abap/ynkj.html"/>
    <updated>2024-09-14T00:57:29.000Z</updated>
    <summary type="html"><![CDATA[
<div class="hint-container tip">
<p class="hint-container-title">提示</p>
<p>接口方向:外部系统-&gt;SAP</p>
</div>
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<div class="hint-container tip">
<p class="hint-container-title">提示</p>
<p>接口方向:外部系统-&gt;SAP</p>
</div>
<!-- 摘要截止标签 -->
<!-- more -->
<p>有内外网差别的，需要basis提供一下支持</p>
<ul>
<li>PO平台的有对应的IP和域名</li>
<li>一般生成的webservice的url地址是域名加端口加接口的信息</li>
<li>我们用的方式是更改端口，并添加外部IP白名单的方式</li>
</ul>
]]></content>
    <category term="SAP"/>
    <published>2024-09-13T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">ODATA</title>
    <id>https://blog.ysf.cc/sap/abap/odata.html</id>
    <link href="https://blog.ysf.cc/sap/abap/odata.html"/>
    <updated>2024-09-23T06:40:16.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
<!-- more -->
<h2>参考资料</h2>
<p><a href="https://wenku.csdn.net/column/4vngztowei" target="_blank" rel="noopener noreferrer">1</a><br>
<a href="https://help.sap.com/docs/ABAP_PLATFORM_NEW/a7b390faab1140c087b8926571e942b7/537758e0deb0477386ea400c915073b3.html?locale=en-US&amp;q=ODATA" target="_blank" rel="noopener noreferrer">2</a><br>
<a href="https://help.sap.com/docs/ABAP_PLATFORM_NEW/6f3c61a7a5b94447b80e72f722b0aad7/4166e6938652441d90261fcc3eca45b6.html?locale=en-US&amp;version=201909.latest" target="_blank" rel="noopener noreferrer">3</a><br>
<a href="https://blog.csdn.net/champaignwolf/article/details/128804590" target="_blank" rel="noopener noreferrer">4</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-09-13T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">调用外部openapi</title>
    <id>https://blog.ysf.cc/sap/abap/api.html</id>
    <link href="https://blog.ysf.cc/sap/abap/api.html"/>
    <updated>2025-07-16T02:44:30.000Z</updated>
    <summary type="html"><![CDATA[
<p>这次我调用的是<a href="https://openapi-ng.maycur.com/invoice/invoiceExport.html" target="_blank" rel="noopener noreferrer">每刻的发票台账标记接口公开api</a>，使用的是IF_HTTP_CLIENT</p>
]]></summary>
    <content type="html"><![CDATA[
<p>这次我调用的是<a href="https://openapi-ng.maycur.com/invoice/invoiceExport.html" target="_blank" rel="noopener noreferrer">每刻的发票台账标记接口公开api</a>，使用的是IF_HTTP_CLIENT</p>
<!-- more -->
<h2>注意点</h2>
<ul>
<li>第一次返回404，排查发现是SAP对接口的地址有拦截，让basis加一下</li>
<li>返回500，有可能是网络不好，也有可能是SSL加密证书没有导入SAP，导入下</li>
<li>记得先调用<a href="https://openapi-ng.maycur.com/develop-guide/api-login.html" target="_blank" rel="noopener noreferrer">接口认证接口</a>获取token等必要数据，当然不是每个api都需要</li>
<li>通过json发送的，注意发生的json格式和对方要求的一样</li>
<li>ABAP结构序列化转换为json发生json，反序列化从json转换为ABAP结构接收信息</li>
<li>网络不好常常出现500 Connection Timed Out，SSL握手失败ICMETIMEOUT（-5），RZ11将参数icm/conn_timeout从5s改成10s</li>
</ul>
<h2>全部代码</h2>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">```css :collapsed-lines</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">FUNCTION ZFIFU005.</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">*"</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>]]></content>
    <category term="SAP"/>
    <published>2024-08-30T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">ABAP接口类型</title>
    <id>https://blog.ysf.cc/sap/abap/interface.html</id>
    <link href="https://blog.ysf.cc/sap/abap/interface.html"/>
    <updated>2025-06-30T10:10:44.000Z</updated>
    <summary type="html"><![CDATA[
<!-- 下面的语句的作用是引入文本里的内容：WebService，Http等 -->
<p>WebService，Http等</p>
]]></summary>
    <content type="html"><![CDATA[
<!-- 下面的语句的作用是引入文本里的内容：WebService，Http等 -->
<p>WebService，Http等</p>
<!-- more -->
<h2>WebService</h2>
<p>WebService通过网络将某种功能或资源的服务发布出来，供其他应用程序调用和使用。<br>
Web Service 的实现依赖于一组标准和协议，这些标准确保了服务的互操作性和跨平台兼容性。下面是一些关键的技术标准：</p>
<ul>
<li><code>XML（eXtensible Markup Language）数据格式</code></li>
<li><code>SOAP（Simple Object Access Protocol）</code><br>
SOAP是基于XML的消息传递协议。SOAP协议支持通过HTTP、SMTP等多种传输协议，因此它具有高度的灵活性</li>
<li><code>WSDL（Web Services Description Language）</code><br>
WSDL是一种 XML 文档，用于描述 Web Service 的接口、方法、参数和返回值等详细信息。通过 WSDL，服务的提供者可以明确地定义服务的功能，而服务的使用者则可以通过解析 WSDL 文件，了解如何正确地调用该服务</li>
<li><code>UDDI（Universal Description, Discovery, and Integration）</code><br>
UDDI 是一个用于注册和发现 Web Service 的标准。它类似于一个目录服务，允许企业注册其 Web Service，并使其他企业能够查找和使用这些服务。UDDI 提供了一个集中式的目录，使得服务的发布和发现更加便捷。</li>
</ul>
<h3>创建WebService-服务定义</h3>
<ol>
<li>SE37创建Function Module.创建接口<br>
</li>
<li>实用程序-&gt;更多实用程序-&gt;创建Web服务-&gt;来自函数模块Create WebService-&gt;From the FunctionModule：生成服务定义，记录生成的WSDL的url<br>
</li>
<li>在创建WebService的集团输入事物代码：SOAMANAGER，以下操作会因版本的不同而有所不同（或者SICF找APPL_SOAP_MANAGEMENT右键测试服务），完成webservice的配置。进行适当的配置和权限控制，以确保安全性和正确的访问权限。测试时可以设置无密码登录，正式时最好要设置密码<br>
</li>
</ol>
<h3>调用WebService-消费者代理</h3>
<ol>
<li>进入事务码SE80，在EnterpriseServicesBrowser里，创建一个新的ServiceConsumerProxy：客户端代理<br>
</li>
<li>通过SOAMANAGER配置端口信息<br>
</li>
<li>编写ABAP程序调用外部WebService<br>
</li>
</ol>
<h2>http</h2>
<p>cl_http_client</p>
<h2>RFC</h2>
<p>外部系统直接登录SAP调用RFC接口，用户操作时实时调用展示视图不存数据库，不用外部系统做接口，传输速度较快。</p>
<p>用SAP自己的rest和webservice接口服务</p>
<h2>参考资料</h2>
<p><a href="https://mp.weixin.qq.com/s/alqWjZLRFpTZR-jDqFOnfQ" target="_blank" rel="noopener noreferrer">SAP ABAP Web Service 的创建与消费：保姆级教程-汪子熙</a><br>
<a href="https://blog.csdn.net/Li958172829/article/details/140065795" target="_blank" rel="noopener noreferrer">SAP配置发布WebService接口并调用（超级详细）-xiao贱贱</a><br>
<a href="/file/WebService.docx" title="下载文档">下载WebService.docx文档</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-08-23T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">最近小结</title>
    <id>https://blog.ysf.cc/informalessay/tattle/confusion.html</id>
    <link href="https://blog.ysf.cc/informalessay/tattle/confusion.html"/>
    <updated>2024-12-03T08:45:16.000Z</updated>
    <summary type="html"><![CDATA[
<p>文笔不行💃，想写很多也写不出来✈️</p>
]]></summary>
    <content type="html"><![CDATA[
<p>文笔不行💃，想写很多也写不出来✈️</p>
<!-- more -->
<h3>最近在干啥</h3>
<p>最近新建了一个博客(感觉还是不太美观，不过用的开源模板让我自己全部重新构建也不太会)，希望自己能持续更新并慢慢把之前在有道云笔记上的笔记更新过来。<br>
想实现的东西很多，毕业以来都是做的SAP-ABAP的工作，希望能总结梳理一下自己的项目和相关开发技能。<br>
可能因为工作就是ABAP吧，对他的学习欲望并没有多少，可能因为他不会有那种特别有趣的反馈？</p>
<h3>反思</h3>
<p>越学习越发现自己知识的匮乏，但总是没有坚持学一个东西，书更是读不进去，想通过实现一个功能做一个小项目的方式学习。不够专注一会学前端一会学后端啥的。</p>
<!-- <Share /> -->]]></content>
    <category term="随笔"/>
    <published>2024-08-22T20:46:25.000Z</published>
  </entry>
  <entry>
    <title type="text">发现好看的模板</title>
    <id>https://blog.ysf.cc/favorite/blog/template.html</id>
    <link href="https://blog.ysf.cc/favorite/blog/template.html"/>
    <updated>2025-04-10T07:45:17.000Z</updated>
    <summary type="html"><![CDATA[
<p>最近发现了很多好看的博客模板</p>
]]></summary>
    <content type="html"><![CDATA[
<p>最近发现了很多好看的博客模板</p>
<!-- more -->
<ul>
<li>Godruoyi的博客，部署在<code>Cloudflare</code>上，感觉他的图片加载超快，咨询了博主图片是保存在 R2 的，<a href="https://godruoyi.com/posts/how-to-build-your-blog/#%E5%B0%86%E8%B5%84%E6%BA%90%E4%B8%8A%E4%BC%A0%E5%88%B0-s3-%E5%8A%A0%E9%80%9F%E8%AE%BF%E9%97%AE" target="_blank" rel="noopener noreferrer">可以查看这里的文档(自定义图片上传部分)</a>将所有文件(js/css/img)保存到R2作为CDN加速(之后可以在本博客试一下,不过他好像是用Astro构建的，这里是用vite不会搞😮)。<br>
<br></li>
<li>yufan的博客很多功能都是自己写的，大佬啊我看了一下弄不来。</li>
</ul>
<!-- more -->
<h2>资料</h2>
<p><a href="https://github.com/syhily/yufan.me" target="_blank" rel="noopener noreferrer">雨帆的博客</a><br>
<a href="https://godruoyi.com/posts/how-to-build-your-blog/" target="_blank" rel="noopener noreferrer">Godruoyi的博客搭建教程</a><br>
<a href="https://dash.cloudflare.com/" target="_blank" rel="noopener noreferrer">Cloudflare</a><br>
<a href="https://rong6.cn/archives/yun-playlist-downloader" target="_blank" rel="noopener noreferrer">Rong6</a></p>
]]></content>
    <category term="博客"/>
    <published>2024-08-21T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">爬虫</title>
    <id>https://blog.ysf.cc/developer/python/eptile.html</id>
    <link href="https://blog.ysf.cc/developer/python/eptile.html"/>
    <updated>2024-08-21T06:25:34.000Z</updated>
    <summary type="text">网易云爬取
继续正文...</summary>
    <content type="html"><![CDATA[<!-- more -->
<p><a href="https://blog.csdn.net/2302_82189125/article/details/140871398?spm=1001.2100.3001.7377&amp;utm_medium=distribute.pc_feed_blog_category.none-task-blog-classify_tag-3-140871398-null-null.nonecase&amp;depth_1-utm_source=distribute.pc_feed_blog_category.none-task-blog-classify_tag-3-140871398-null-null.nonecase" target="_blank" rel="noopener noreferrer">网易云爬取</a></p>
<p>继续正文...</p>
]]></content>
    <published>2024-08-19T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">下拉框</title>
    <id>https://blog.ysf.cc/sap/abap/droplist.html</id>
    <link href="https://blog.ysf.cc/sap/abap/droplist.html"/>
    <updated>2024-08-22T05:51:13.000Z</updated>
    <summary type="html"><![CDATA[<p>111</p>
]]></summary>
    <content type="html"><![CDATA[<p>111</p>
<!-- more -->
<h2>ALV下拉框实现方式</h2>
]]></content>
    <category term="SAP"/>
    <published>2024-08-15T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">RESTful API</title>
    <id>https://blog.ysf.cc/sap/abap/rest.html</id>
    <link href="https://blog.ysf.cc/sap/abap/rest.html"/>
    <updated>2024-09-23T06:50:04.000Z</updated>
    <summary type="html"><![CDATA[
<div class="hint-container info">
<p class="hint-container-title">相关信息</p>
<p>RESTful API</p>
</div>
]]></summary>
    <content type="html"><![CDATA[
<div class="hint-container info">
<p class="hint-container-title">相关信息</p>
<p>RESTful API</p>
</div>
<!-- more -->
<h2>什么是REST</h2>
<ul>
<li>API定义了应用程序如何交互，Web服务是API的一种实现，专门通过网络提供服务。</li>
<li>RESTful是实现Web服务的一种风格，它提供了一种设计Web服务的方法，使得服务易于使用、可伸缩和可维护。</li>
<li>简而言之，RESTful Web服务是一种特定类型的Web服务，它遵循REST架构原则；而Web服务是实现API的一种方式，可以采用RESTful或其他风格。</li>
</ul>
<p>REST是以Web为平台的选择通过使用http协议和uri，利用client/server model对资源进行CRUD(Create/Read/Update/Delete)增删改查操作的一种架构风格。是腾讯公司或其他公司建立API时要遵守的一种规则/风格，当然也有其他规则可以用。<br>
REST不是"rest"这个单词，而是Resource Representational State Transfer的缩写：通俗来讲就是：资源在网络中以某种表现形式进行状态转移。abap中可以通过实现IF_HTTP_EXTENSION接口并使用SICF（SAP Internet Communication Framework）来发布RESTful服务</p>
<blockquote>
<p>Resource：资源，即数据（网络的核心）。<br>
Representational：某种表现形式，比如用JSON，XML，JPEG等；<br>
State Transfer：状态变化。通过HTTP动词实现。</p>
</blockquote>
<p>Web端不再用之前典型的PHP或JSP架构，而是改为前段渲染和附带处理简单的商务逻辑。Web端和Server只使用上述定义的API来传递数据和改变数据状态。格式一般是JSON。</p>
<p>对于资源的具体操作类型，由HTTP动词表示。常用的HTTP动词有下面五个（括号里是对应的SQL命令）：</p>
<ol>
<li>GET（SELECT）： 从服务器获取资源(一项或多项)</li>
<li>POST（CREATE）： 在服务器新建一个资源</li>
<li>PUT（UPDATE）： 在服务器更新资源（客户端提供改变后的完整资源）</li>
<li>PATCH（UPDATE）： 在服务器更新资源（客户端提供改变的属性）</li>
<li>DELETE（DELETE）：从服务器删除资源。</li>
</ol>
<p>返回状态<br>
| 状态码 | 描述                             |<br>
|</p>
]]></content>
    <category term="SAP"/>
    <published>2024-08-14T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">算法</title>
    <id>https://blog.ysf.cc/developer/algorithm/begin.html</id>
    <link href="https://blog.ysf.cc/developer/algorithm/begin.html"/>
    <updated>2024-08-13T06:10:10.000Z</updated>
    <summary type="html"><![CDATA[<p><a href="https://www.hello-algo.com/chapter_hello_algo/" target="_blank" rel="noopener noreferrer">hello 算法</a></p>
]]></summary>
    <content type="html"><![CDATA[<p><a href="https://www.hello-algo.com/chapter_hello_algo/" target="_blank" rel="noopener noreferrer">hello 算法</a></p>
<!-- more -->
<p>继续正文...</p>
]]></content>
    <published>2024-08-13T06:10:10.000Z</published>
  </entry>
  <entry>
    <title type="text">bash脚本</title>
    <id>https://blog.ysf.cc/developer/shell/bash.html</id>
    <link href="https://blog.ysf.cc/developer/shell/bash.html"/>
    <updated>2024-11-08T05:30:58.000Z</updated>
    <summary type="html"><![CDATA[<div class="hint-container tip">
<p class="hint-container-title">相关阅读</p>
</div>
<h2>资料</h2>
<p><a href="https://wangdoc.com/bash/intro" target="_blank" rel="noopener noreferrer">001-Bash脚本教程</a></p>
]]></summary>
    <content type="html"><![CDATA[<div class="hint-container tip">
<p class="hint-container-title">相关阅读</p>
</div>
<h2>资料</h2>
<p><a href="https://wangdoc.com/bash/intro" target="_blank" rel="noopener noreferrer">001-Bash脚本教程</a></p>
<!-- more -->
<p>ctrl + u查看网站代码，查看网页前端代码F12</p>
<h2>基本语法</h2>
<p><a href="https://wangdoc.com/bash/grammar" target="_blank" rel="noopener noreferrer">基本语法</a></p>
<h3>参数</h3>
<ul>
<li>-n<br>
默认情况下，echo输出的文本末尾会有一个回车符。-n参数可以取消末尾的回车符，使得下一个提示符紧跟在输出内容的后面。</li>
</ul>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> b</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">b</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> b</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ab</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>-e<br>
-e参数会解释引号（双引号和单引号）里面的特殊字符（比如换行符\n）。如果不使用-e参数，即默认情况下，引号会让特殊字符变成普通字符，echo不解释它们，原样输出。</li>
</ul>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "Hello\nWorld"</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Hello\nWorld</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 双引号的情况</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "Hello\nWorld"</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Hello</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">World</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 单引号的情况</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> echo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'Hello\nWorld'</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">Hello</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">World</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>快捷键</h3>
<ul>
<li><code>Ctrl + L</code>：清除屏幕并将当前行移到页面顶部。</li>
<li><code>Ctrl + C</code>：中止当前正在执行的命令。</li>
<li><code>Shift + PageUp</code>：向上滚动。</li>
<li><code>Shift + PageDown</code>：向下滚动。</li>
<li><code>Ctrl + U</code>：从光标位置删除到行首。</li>
<li><code>Ctrl + K</code>：从光标位置删除到行尾。</li>
<li><code>Ctrl + W</code>：删除光标位置前一个单词。</li>
<li><code>Ctrl + D</code>：关闭 Shell 会话。</li>
<li><code>↑，↓</code>：浏览已执行命令的历史记录。</li>
<li><code>Tab</code>: 自动补全代码。</li>
</ul>
<h2>模式扩展</h2>
<p>这里内容很多，就不誊写了<br>
<a href="https://wangdoc.com/bash/expansion" target="_blank" rel="noopener noreferrer">模式扩展</a></p>
<h2>引号和转义</h2>
<p>转义字符和here文档</p>
]]></content>
    <published>2024-08-13T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">Ranges</title>
    <id>https://blog.ysf.cc/sap/abap/ranges.html</id>
    <link href="https://blog.ysf.cc/sap/abap/ranges.html"/>
    <updated>2024-08-22T09:57:43.000Z</updated>
    <summary type="html"><![CDATA[
<p>RANGES &lt;变量名&gt; FOR &lt;变量类型&gt;</p>
]]></summary>
    <content type="html"><![CDATA[
<p>RANGES &lt;变量名&gt; FOR &lt;变量类型&gt;</p>
<!-- more -->
<h2>使用方式</h2>
<p>是自带表头的内表</p>
<p>| 名称 | 参考值 | 描述 |<br>
|</p>
]]></content>
    <category term="SAP"/>
    <published>2024-08-09T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">go初学</title>
    <id>https://blog.ysf.cc/developer/golang/begin.html</id>
    <link href="https://blog.ysf.cc/developer/golang/begin.html"/>
    <updated>2025-09-29T02:29:48.000Z</updated>
    <summary type="text">新手开源项目
继续正文...
Golang 中文学习文档
Go 指南
go.dev</summary>
    <content type="html"><![CDATA[<!-- more -->
<p><a href="https://www.cnblogs.com/xueweihan/p/13997806.html" target="_blank" rel="noopener noreferrer">新手开源项目</a></p>
<p>继续正文...</p>
<p><a href="https://golang.halfiisland.com/" target="_blank" rel="noopener noreferrer">Golang 中文学习文档</a><br>
<a href="https://tour.go-zh.org/list" target="_blank" rel="noopener noreferrer">Go 指南</a><br>
<a href="https://go.dev/learn" target="_blank" rel="noopener noreferrer">go.dev</a></p>
]]></content>
    <published>2024-08-06T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">定时任务</title>
    <id>https://blog.ysf.cc/sap/abap/sche_task.html</id>
    <link href="https://blog.ysf.cc/sap/abap/sche_task.html"/>
    <updated>2024-09-23T06:50:04.000Z</updated>
    <summary type="html"><![CDATA[<p>123</p>
]]></summary>
    <content type="html"><![CDATA[<p>123</p>
<!-- more -->
<h2>设置定时任务</h2>
<h2 class="custom-small-title">查看定时任务</h2>
<!-- <Catalog base='/' hideHeading/> -->
]]></content>
    <category term="SAP"/>
    <published>2024-08-09T06:34:48.000Z</published>
  </entry>
  <entry>
    <title type="text">PO</title>
    <id>https://blog.ysf.cc/sap/abap/po.html</id>
    <link href="https://blog.ysf.cc/sap/abap/po.html"/>
    <updated>2024-11-08T05:30:58.000Z</updated>
    <summary type="html"><![CDATA[<h2>集成技术</h2>
<p>SAP PO（SAP Process Orchestration）是一个集成平台，用于处理企业内部和外部系统之间的通信和数据交换。</p>
]]></summary>
    <content type="html"><![CDATA[<h2>集成技术</h2>
<p>SAP PO（SAP Process Orchestration）是一个集成平台，用于处理企业内部和外部系统之间的通信和数据交换。</p>
<!-- more -->
<h1>SAP PO中间件学习</h1>
<h2>新增外部系统-&gt;SAP接口</h2>
<ul>
<li>如果没有产品先去创建产品及产品组件</li>
<li>将产品组件分配到对应的技术系统</li>
<li>PO端ESB配置:命名空间，SI,MM,OM等</li>
<li>PO端IB配置:BS,BC,IC</li>
</ul>
<h2>注意</h2>
<ul>
<li>更改映射字段的时候，注意不要更改原有的functions转换。</li>
<li>需要建PO账号做登陆身份验证等</li>
</ul>
<h2>问题</h2>
<h3><strong>1. 金额,字符串替代</strong></h3>
<p>JCO_ERROR_CONVERSION:数字10780000.00不能在PREIS字段编码为长度为11、小数点后两位的BCD</p>
<figure><img src="/img/po1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>字符串转换为11位然后有两位小数的金额<br>
当10,100.00只有一个逗号可以成功，当有10,780,000.00 两个逗号时映射会失败<br>
需要使用replaceString函数就行转换将,转换为空。</p>
<h3><strong>2. 账号未登录或者账号密码错误</strong></h3>
<p>，或者HTTP/1.1 401 Unauthorized。</p>
<h3><strong>3. RFC 适配器：接收者处理错误 (RFC 适配器中存在接收者处理错误)</strong></h3>
<p><br>
<br>
RFC适配器的密码错误更新一下(SAP的账号密码)，可以在这里进行PING测试查看通道是否正常<br>
</p>
<p>SOAPUI中填的两次账号密码都是PO的账号不是SAP的账号密码。<br>
</p>
<h3><strong>4. 同步产品，技术系统等</strong></h3>
<figure><figcaption>alt text</figcaption></figure>
<h3><strong>5. postman测试GET成功POST失败</strong></h3>
<p>填写的url是webservice地址(postman里get成功，但post会报错405方法不允许)，post方法的地址需要是webservice里的普通的soap地址(saopui里输入webservice后生成的地址)。<br>
</p>
<h2>参考资料</h2>
<p><a href="https://comment.yesuifeng.cc/" target="_blank" rel="noopener noreferrer">waline 挂载域名二级地址</a><br>
<a href="https://blog.csdn.net/XLevon/article/details/126773935?spm=1001.2101.3001.6650.7&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-7-126773935-blog-117328805.235%5Ev43%5Epc_blog_bottom_relevance_base6&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-7-126773935-blog-117328805.235%5Ev43%5Epc_blog_bottom_relevance_base6&amp;utm_relevant_index=8" target="_blank" rel="noopener noreferrer">SAP PO 接口配置完整教程之一RFC服务发布</a><br>
<a href="https://blog.csdn.net/XLevon/article/details/126904513" target="_blank" rel="noopener noreferrer">SAP PO 接口配置完整教程之二REST服务对接</a><br>
<a href="https://www.cnblogs.com/weixiaopeng/p/11888347.html" target="_blank" rel="noopener noreferrer">PO/PI 系统蓝图(SLD),企业服务存储库(ESR),集成目录(ID)基础配置 - 女鬼的朋友 - 博客园 (cnblogs.com)</a><br>
<a href="https://blog.csdn.net/yhahaha_/article/details/93716263" target="_blank" rel="noopener noreferrer">WSDL详解</a><br>
<a href="https://blog.csdn.net/qq_44826887/article/details/134922069" target="_blank" rel="noopener noreferrer">PO 发布外围系统REST-＞SAP RFC同步接口</a><br>
<a href="https://blog.csdn.net/qq_44826887/article/details/135170299" target="_blank" rel="noopener noreferrer">PO 发布SAP SProxy-＞外围系统 WebService</a><br>
<a href="https://blog.csdn.net/XLevon/article/details/129370475" target="_blank" rel="noopener noreferrer">【SAP PO】X-DOC：SAP PO 接口配置完整教程之三REST服务发布&amp;报文转换</a><br>
<a href="https://blog.csdn.net/JYH1999/article/details/108716107" target="_blank" rel="noopener noreferrer">SAP PO常用的基本组件介绍与创建</a><br>
<a href="/file/SapPoUserCreate.docx" title="下载文档">下载SAP PO创建用户操作手册</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-10-25T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">shell初学</title>
    <id>https://blog.ysf.cc/developer/shell/begin.html</id>
    <link href="https://blog.ysf.cc/developer/shell/begin.html"/>
    <updated>2025-09-29T02:31:04.395Z</updated>
    <summary type="html"><![CDATA[
<p>Shell-用户跟内核交互的对话界面(kernel-内核)。</p>
]]></summary>
    <content type="html"><![CDATA[
<p>Shell-用户跟内核交互的对话界面(kernel-内核)。</p>
<!-- more -->
<p>终端，外表看起来就只是一个窗口，上面可以键入字符，当你输入特定字符的时候它会打印出一些反馈。这个字符一般就是<a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer">Shell 命令</a>。<br>
MacOS 现在默认的 shell 解释器是 <a href="https://www.duidaima.com/Group/Topic/OtherTools/17940" target="_blank" rel="noopener noreferrer">Zsh</a>;<br>
Linux 上的一般默认为 <a href="https://zh.wikipedia.org/wiki/Bash" target="_blank" rel="noopener noreferrer">Bash</a>;<br>
Windows 下默认为 <a href="https://zh.wikipedia.org/wiki/PowerShell" target="_blank" rel="noopener noreferrer">PowerShell</a>;</p>
<div class="hint-container tip">
<p class="hint-container-title">相关阅读</p>
<p><a href="https://learn.microsoft.com/zh-cn/windows/terminal/install" target="_blank" rel="noopener noreferrer">安装并开始设置 Windows 终端</a></p>
<p><a href="https://support.apple.com/zh-cn/guide/terminal/welcome/mac" target="_blank" rel="noopener noreferrer">macOS 终端使用手册</a></p>
<p><a href="https://blog.csdn.net/WQY867047910/article/details/134788517" target="_blank" rel="noopener noreferrer">80 个常用 shell 命令及简单用法</a></p>
</div>
<h2>资料</h2>
<p>(<a href="https://itsfoss.com/view-file-contents/" target="_blank" rel="noopener noreferrer">https://itsfoss.com/view-file-contents/</a>)<br>
(<a href="https://linux.cn/article-16104-1.html" target="_blank" rel="noopener noreferrer">https://linux.cn/article-16104-1.html</a>)<br>
<a href="https://linux.cn/article-16120-1.html" target="_blank" rel="noopener noreferrer">Bash编程脚本入门</a></p>
<h2>常用命令</h2>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#查看主目录中的目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">ls</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#更改目录</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> #某目录目录(文件夹)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2>基础技巧</h2>
<p><a href="https://itsfoss.com/basic-terminal-tips-ubuntu/#8-getting-help" target="_blank" rel="noopener noreferrer">19个基础技巧</a></p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 寻求帮助</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">command_name</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">command_name</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -help</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Ctrl+C 用于停止命令或进程</strong><br>
Ctrl+Shift+C,Ctrl+Shift+V用于复制粘贴</p>
<p><strong>一次运行多个命令</strong><br>
| 命令 | 用法 | 运行顺序 |<br>
|</p>
]]></content>
    <published>2024-08-07T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">日程</title>
    <id>https://blog.ysf.cc/favorite/schedule.html</id>
    <link href="https://blog.ysf.cc/favorite/schedule.html"/>
    <updated>2024-12-13T08:22:07.000Z</updated>
    <summary type="html"><![CDATA[
<p>以下是我的任务列表，包括已完成和未完成的任务。<br>
列的很多，都没干很好，下次不列了</p>
]]></summary>
    <content type="html"><![CDATA[
<p>以下是我的任务列表，包括已完成和未完成的任务。<br>
列的很多，都没干很好，下次不列了</p>
<!-- more -->
<h2>未完成 Pending</h2>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> OLE和abap2xlsx是啥</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-1" disabled="disabled"><label class="task-list-item-label" for="task-item-1"> 学习算法</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-2" disabled="disabled"><label class="task-list-item-label" for="task-item-2"> 学习操作系统，bash shell  <a href="https://linux.cn/article-16120-1.html" target="_blank" rel="noopener noreferrer">bash脚本编程入门</a></label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-3" disabled="disabled"><label class="task-list-item-label" for="task-item-3"> 观看前端入门教程3h</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-4" disabled="disabled"><label class="task-list-item-label" for="task-item-4"> 学习python</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-5" disabled="disabled"><label class="task-list-item-label" for="task-item-5"> 学习爬虫，逆向等（js，汇编逆向等<a href="https://docs.qq.com/sheet/DVGpBYU5JYVZXQmRL" target="_blank" rel="noopener noreferrer">案例</a></label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-6" disabled="disabled"><label class="task-list-item-label" for="task-item-6"> 学习博客剩余配置</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-7" disabled="disabled"><label class="task-list-item-label" for="task-item-7"> 学习node.js和go语言，了解也行</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-8" disabled="disabled"><label class="task-list-item-label" for="task-item-8"> 研究一下sq01，02，03</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-9" disabled="disabled"><label class="task-list-item-label" for="task-item-9"> 智能桌宠单片机</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-10" disabled="disabled"><label class="task-list-item-label" for="task-item-10"> excel，smw0</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-11" disabled="disabled"><label class="task-list-item-label" for="task-item-11"> ODATA,API</label></li>
</ul>
<h2>已完成 Completed</h2>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-12" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-12"> 学习 Vue.js 基础</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-13" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-13"> 完成 VuePress 项目设置</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-14" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-14"> 编写第一个 Markdown 文档</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-15" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-15"> 整理PO</label></li>
</ul>
]]></content>
    <published>2024-08-05T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">事务代码</title>
    <id>https://blog.ysf.cc/sap/tcode.html</id>
    <link href="https://blog.ysf.cc/sap/tcode.html"/>
    <updated>2025-07-08T06:27:42.000Z</updated>
    <summary type="html"><![CDATA[
<!-- ## 目录

- [ABAP 常用事务代码](#abap-常用事务代码)
- [FICO 常用事务代码](#fico-常用事务代码)
- [PP (生产计划) 常用事务代码](#pp-生产计划-常用事务代码)
- [MM (物料管理) 常用事务代码](#mm-物料管理-常用事务代码)
- [SD (销售与分销) 常用事务代码](#sd-销售与分销-常用事务代码)
- [BASIS (系统管理) 常用事务代码](#basis-系统管理-常用事务代码)
- [EWM (扩展仓库管理) 常用事务代码](#ewm-扩展仓库管理-常用事务代码)
- [SAP NETWEAVER 相关事务代码](#sap-netweaver-相关事务代码) -->]]></summary>
    <content type="html"><![CDATA[
<!-- ## 目录

- [ABAP 常用事务代码](#abap-常用事务代码)
- [FICO 常用事务代码](#fico-常用事务代码)
- [PP (生产计划) 常用事务代码](#pp-生产计划-常用事务代码)
- [MM (物料管理) 常用事务代码](#mm-物料管理-常用事务代码)
- [SD (销售与分销) 常用事务代码](#sd-销售与分销-常用事务代码)
- [BASIS (系统管理) 常用事务代码](#basis-系统管理-常用事务代码)
- [EWM (扩展仓库管理) 常用事务代码](#ewm-扩展仓库管理-常用事务代码)
- [SAP NETWEAVER 相关事务代码](#sap-netweaver-相关事务代码) -->
<h2>ABAP 常用事务代码</h2>
<p>事物代码这种最好都通过SAP菜单路径去查，这是一个好习惯。</p>
<p>| 事务代码 | 描述 |<br>
|</p>
]]></content>
    <category term="SAP"/>
    <published>2024-08-02T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">数据库表</title>
    <id>https://blog.ysf.cc/sap/table.html</id>
    <link href="https://blog.ysf.cc/sap/table.html"/>
    <updated>2025-07-16T02:44:30.000Z</updated>
    <summary type="html"><![CDATA[<p><code>MM</code>、<code>FICO</code>、<code>SD</code>等多个模块的常用表</p>
]]></summary>
    <content type="html"><![CDATA[<p><code>MM</code>、<code>FICO</code>、<code>SD</code>等多个模块的常用表</p>
<!-- more -->
<h1>SAP 常用表速查</h1>
<h2>ABAP 常用表</h2>
<p>| 常用表 | 描述 |<br>
|</p>
]]></content>
    <published>2024-08-02T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">工具箱</title>
    <id>https://blog.ysf.cc/favorite/links/tool.html</id>
    <link href="https://blog.ysf.cc/favorite/links/tool.html"/>
    <updated>2025-09-12T03:15:08.000Z</updated>
    <summary type="html"><![CDATA[
<div class="hint-container tip">
<p class="hint-container-title">好用的在线工具</p>
</div>
<h2></h2>
]]></summary>
    <content type="html"><![CDATA[
<div class="hint-container tip">
<p class="hint-container-title">好用的在线工具</p>
</div>
<h2></h2>
]]></content>
    <published>2024-08-01T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">博客搭建</title>
    <id>https://blog.ysf.cc/favorite/blog/help.html</id>
    <link href="https://blog.ysf.cc/favorite/blog/help.html"/>
    <updated>2025-06-30T10:10:44.000Z</updated>
    <summary type="html"><![CDATA[
<!-- 要么用
```
``` -->
<p>选择的是<a href="https://theme-hope.vuejs.press/zh/" target="_blank" rel="noopener noreferrer">vuepress-theme-hope</a>主题,采用了<a href="https://blog.mo7.cc/" target="_blank" rel="noopener noreferrer">墨七大佬</a>的模板。</p>
]]></summary>
    <content type="html"><![CDATA[
<!-- 要么用
```
``` -->
<p>选择的是<a href="https://theme-hope.vuejs.press/zh/" target="_blank" rel="noopener noreferrer">vuepress-theme-hope</a>主题,采用了<a href="https://blog.mo7.cc/" target="_blank" rel="noopener noreferrer">墨七大佬</a>的模板。</p>
<!-- more -->
<p>多搜索&lt;大佬说最好用bing或者google&gt;，多尝试，但也记得备份，不小心搞崩溃就不好了📘。感觉搭建博客还是需要前端的知识多点，http,vue,css,shell,js，markdown啥的。</p>
<p><em>搭建步骤</em></p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> clone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://github.com/mo7cc/blog-source.git</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 或者直接下载github的zip</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>手动创建文件或者直接下载模板</li>
<li>初始化，下载依赖</li>
<li>编写博客，插件，样式什么的可以修改一下（我不会🐶）</li>
<li>新建仓库，上传部署（因为用的是静态网站，我这里是部署的dist文件就行）</li>
</ul>
<h2>出现的问题</h2>
<h3><a class="header-anchor" href="#问题1-git-报错-failed-to-connect-to-github-com-port-443-after-21096-ms-couldn-t-connect-to-server"><span>问题1：Git 报错 Failed to connect to </span></a><a href="http://github.com" target="_blank" rel="noopener noreferrer">github.com</a> port 443 after 21096 ms: Couldn‘t connect to server</h3>
<p>出现这类报错，可能是由于网络代理引起的，使用以下代码进行重置 git 的代理设置即可。</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --global</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --unset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> http.proxy</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --global</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --unset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https.proxy</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><p>也有可能是当前本地预览没关闭关了再试，或者网络不行。</p>
<p><a href="https://blog.csdn.net/qq_40296909/article/details/134285451" target="_blank" rel="noopener noreferrer">解决使用git时遇到Failed to connect to github.com port 443 after 21090 ms: Couldn‘t connect to server</a></p>
<h3>问题2：This is usually caused by another repository pushing to the same ref</h3>
<p>翻译成中文就是:这通常是由另一个存储库推送到同一引用引起的。<br>
解决方法：</p>
<ol>
<li>首先，使用git pull --rebase origin master命令拉取，如下代码所示：</li>
<li>接着，使用git push -u origin master命令上传代码，如下代码所示：</li>
</ol>
<h3>问题3：bulid打包错误</h3>
<p>如果你正在dev本地运行，进行build打包的时候会报错。</p>
<h3>问题4：上传至github报错</h3>
<p>之前都好好的，用脚本推送部署master和gh-pages分支，最近突然连接失败一直超时<code>ssh: connect to host github.com port 22: Connection timed out fatal: Could not read from remote repository.</code>，一开始我还以为是密匙的问题嘞，感觉不是。</p>
<!-- <br /> -->
<p>我怀疑是网络对SSH的22端口阻止了，当我把ssh的config的端口从22改成443时，部署gh-pages成功了，master还是失败，我猜想因为443是HTTPS的默认端口，而分支是博客生成的html文件所以成功，但master是原始文件有各种形式的文件所以失败了。怎么解决哦，有点小烦。<br>
</p>
<ul>
<li>强制推送到远程master分支报错<br>
git push origin master --force<br>
通过这个成功了<a href="https://blog.csdn.net/qq_40296909/article/details/134285451" target="_blank" rel="noopener noreferrer">解决使用git时遇到Failed to connect to github.com port 443 after 21090 ms: Couldn‘t connect to server</a>。开过VPN导致的本机系统端口号和git的端口号不一致导致的。<br>
</li>
</ul>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> http.proxy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.1:7890</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https.proxy</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 127.0.0.1:7890</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div></div></div><ul>
<li>部署分支报错<br>
git push -f git@github.com:20000428/bloghope.git master:gh-pages<br>
<a href="https://blog.csdn.net/kuilaurence/article/details/135909974" target="_blank" rel="noopener noreferrer">解决ssh: connect to host github.com port 22: Connection timed out</a></li>
</ul>
<div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// ~\.ssh</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// 单行注释</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">/*  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  Host github.com</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  HostName ssh.github.com</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  Port 443</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  User git</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  IdentityFile ~/.ssh/id_rsa</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*/</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>关于 Error: ENOTEMPTY: directory not empty, rmdir 'D:\Documents\code\MyGitee\blog-source-main.vscode.vp-temp.server\pwa' 的错误<br>
你可以手动清理该目录下的内容，确保目录为空，然后再重新运行构建命令。或者检查是否有其他进程正在使用该目录，结束相关进程后再尝试构建。删除本地预览的进程(pnpm run dev生成的那个)</p>
<h2>已完成的工作</h2>
<h3>部署步骤（不保真,不是按顺序来的）</h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#初始化推送master分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> init</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "Init"</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> https://gitee.com/xxxxxxx/myblog-demo.git</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> remote</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -v</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> #查看当前关联的远程仓库，如果已经有了一个origin，那么你可以通过</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> rm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> origin来移除它</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "master"</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#之后更改可以用，强制推送到远程master分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> master</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --force</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> branch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">branch-nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 新建分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> checkout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">branch-nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 切换到新建的分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> checkout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">branch-nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 新建并切换到新分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> new-branch</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> #使用以下命令将新分支推送到远程仓库：</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">remote_nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt; </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">--delete</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">branch_nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">e&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">删除远程分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> feature-x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  删除名为feature-x的本地分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> origin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --delete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> feature-x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 删除名为feature-x的远程分支</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> dist</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> --force</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> github</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 更新分支</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 一切以本地为主</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#后续本地修改代码记得执行下面的命令，进入对应工作目录即可</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">npm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> build</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> "修改"</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 以上推送部署master分支的操作可以直接用脚本运行</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#./_shell/deploy01.sh</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>推送静态网站文件到gh-pages分支推送之前要先进行GitHub的SSH密钥指纹添加。<br>
如图:</p>
<figure><img src="https://cdn.jsdelivr.net/gh/20000428/PictureBed/img/SSH.png" alt="SSH秘钥" tabindex="0" loading="lazy"><figcaption>SSH秘钥</figcaption></figure>
<p>推送分支:</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#!/usr/bin/env sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 确保脚本抛出遇到的错误</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">set</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -e</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 生成静态文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">pnpm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 进入生成的文件夹</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> src/.vuepress/dist</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #看你生成的dist文件在哪，这是目标的默认地址</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#我的直接cd dist，因为我改了config.ts文件的  dest: 'dist',路径。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 如果是发布到自定义域名</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># echo 'www.example.com' &gt; CNAME</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> init</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> add</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -A</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> # 暂存所有(新的、修改的、删除的)文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'deploy'</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 如果发布到 https://&lt;USERNAME&gt;.github.io</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># git push -f git@github.com:&lt;USERNAME&gt;/&lt;USERNAME&gt;.github.io.git master</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 如果发布到 https://&lt;USERNAME&gt;.github.io/&lt;REPO&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> push</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> git@github.com:20000428/bloghope.git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> master:gh-pages</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> -</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 以上推送部署gh-pages分支的操作可以直接用脚本运行</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#./_shell/mydeploy.sh</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3>图床搭建</h3>
<p>使用<a href="https://blog.csdn.net/xdnxl/article/details/129466060" target="_blank" rel="noopener noreferrer">github</a>搭建,具体可以看<a href="https://blog.mo7.cc/tutorial/vuepress-hope/step_icon_nav.html" target="_blank" rel="noopener noreferrer">大佬的教程</a></p>
<h2>仍存在的问题</h2>
<ul>
<li>
<p>利用CDN加速静态资源如图片<br>
看图片能不能存在Cloudfare R2上，感觉会快很多<a href="https://godruoyi.com/posts/how-to-build-your-blog/#%E5%B0%86%E8%B5%84%E6%BA%90%E4%B8%8A%E4%BC%A0%E5%88%B0-s3-%E5%8A%A0%E9%80%9F%E8%AE%BF%E9%97%AE" target="_blank" rel="noopener noreferrer">别的博主</a></p>
</li>
<li>
<p>看看站点流量统计用Google Analytics，图表啥的我看别的博主很好看</p>
</li>
<li>
<p>可以搞个站点服务状态，如下<br>
服务器开始运行于2014年12月24日，已运行 3529 天。<br>
博客归档：文章数：437，页面数：9，评论数：1631。<br>
运维状态： 证书有效期剩余 37 天 ，域名有效期剩余 50 天 。</p>
</li>
<li>
<p>音乐插件（服务）仍不会更改<br>
<a href="https://aplayer.js.org/#/zh-Hans/" target="_blank" rel="noopener noreferrer">APlayer</a>插件，通过接口调用网易云API，部署到网页。</p>
</li>
<li>
<p><s>显示在主页的有日期的博文显示多少内容</s><br>
<s>不知道是不是有链接就截止，还是有<code> </code>代码块，还是有什么其他逻辑</s>暂时用分隔符解决。</p>
</li>
<li>
<p><s>没有域名(域名实名注册局审核中)</s>，没有文件服务器，没有对话服务器</p>
</li>
<li>
<p>每日壁纸还不会改</p>
</li>
<li>
<p><s>评论系统只有我自己能交互，其他人的网络无法连接</s><br>
<s><a href="https://waline-three-sooty.vercel.app/" target="_blank" rel="noopener noreferrer">我的waline</a>，已经成功搭建。可能是Nginx没有配置，所以其它网络的人不能访问？</s><a href="https://blog.csdn.net/Panzer_Jack/article/details/127418379" target="_blank" rel="noopener noreferrer">vercal.app国内无法访问</a><br>
<s>评论收不到邮件😟在vercal上配置相应环境变量</s></p>
</li>
<li>
<p>对于脚本还不会用</p>
</li>
<li>
<p>英文版本还未修改</p>
</li>
<li>
<p><s>标题herotext字体样式还不会修改</s></p>
</li>
</ul>
<h2>踩坑</h2>
<blockquote>
<p>base得是自己的路径不然生成的网页没有样式<br>
我多数情况下是代理的网络不行😂<br>
有很多问题清除缓存可以解决<br>
文章使用了相同的地址permalink<br>
连接github可能需要外网，使用代理或者啥</p>
</blockquote>
<h2>附加</h2>
<p><a href="https://www.cnblogs.com/xiaostudy/p/16351639.html" target="_blank" rel="noopener noreferrer">markdown emoji大全</a><br>
<a href="https://waline-three-sooty.vercel.app" target="_blank" rel="noopener noreferrer">waline 地址</a><a href="https://waline.js.org/" target="_blank" rel="noopener noreferrer">官网</a><br>
<a href="https://comment.yesuifeng.cc/" target="_blank" rel="noopener noreferrer">waline 挂载域名二级地址</a><br>
<a href="https://www.cnblogs.com/yyl001/p/17326339.html" target="_blank" rel="noopener noreferrer">VsCode调试vue</a><br>
<a href="https://blog.csdn.net/qq_40296909/article/details/134285451" target="_blank" rel="noopener noreferrer">解决使用git时遇到Failed to connect to github.com port 443 after 21090 ms: Couldn‘t connect to server-前端大白菜123</a><br>
<a href="https://blog.csdn.net/kuilaurence/article/details/135909974" target="_blank" rel="noopener noreferrer">解决ssh: connect to host github.com port 22: Connection timed out-kuilaurence</a><br>
<a href="https://leelaa.cn/posts/ahniDa" target="_blank" rel="noopener noreferrer">git代理</a><br>
<a href="https://blog.csdn.net/qq_34902437/article/details/140298754" target="_blank" rel="noopener noreferrer">Github Page 添加自定义域名-码的艺术家</a></p>
]]></content>
    <category term="博客"/>
    <published>2024-07-30T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">关于我</title>
    <id>https://blog.ysf.cc/about/me.html</id>
    <link href="https://blog.ysf.cc/about/me.html"/>
    <updated>2024-08-16T06:23:06.000Z</updated>
    <summary type="html"><![CDATA[
<h2>叶随风(<em>LeafinWind</em>)</h2>
<p>我是『叶随风』，一条咸鱼。</p>
<!-- 
我叫『墨七』，一名非典型程序员。热爱编程，喜欢拥抱新技术，妄图改变世界，企图让世界因我而美好。

一名全站工程师，在多个开发领域都有着比较丰富的开发经验。

> 墨七 , mo7 , Mo7

## 关于爱好

写代码给我带来过很多快乐，也曾在我内心最悲伤的时候陪伴我走出阴影。

经常会突发奇想，喜欢自己设计构想，然后自己动手实现的那种成就感。写出来的东西被大家认可也会给我带来极大的满足感。

编码上头时，可以十几个小时不吃不睡依然精神；但也会一口气睡上十几个小时雷打不动(睡眠质量特别高，躺床上 10 分钟就没了意识，深度睡眠基本都在 4 小时往上)。

喜欢篮球，曾是校队成员；喜欢电影、游戏、美食、阅读和思考。喜欢创造，喜欢看着自己亲手建立的东西一点点完善。

喜欢玩原神、星际争霸、在 Steam 上体验各种大作。曾经的暴雪粉。

## 关于理想

愿世界和平，愿所有的种子都能开花结果，愿有情人终成眷属，愿好人一生平安。

但愿望终归只是愿望，我唯一能做的事情就是在目之所及之处做到最好，在自己能力范围之内发挥自己所长帮助更多的人。

## 关于本站

本站采用
[VuePress](https://v2.vuepress.vuejs.org) 搭建，
基于主题 [ThemeHope](https://theme-hope.vuejs.press) 由个人魔改而成。

关于更多信息可阅读 [关于本站](./关于本站.md)

在日常的工作和学习当中我积累了大量的经验、知识和技巧，他们被我用 md 记录了下来存储在 Github 的私人仓库之上。

![](./image/intro.png)

并且还有一些想法，想要表达的思想和观点等。我不太愿意将这些东西公布在各种公众平台之上，因为当我的知识变成了数据，那么这些数据的安全和版权应当由我自己负责，

写博客，并不仅仅只是为了表达，更是一种`记忆`和`修身养性`的方式，让自己浮躁的生活跟心情沉淀下来的一种手段。我希望过个七年八年的，再回首打开这个站点的时候，它能变成一种财富和寄托。

---

> 请记住域名 `mo7.cc` , 希望我们能成为朋友 :wink: ~ -->]]></summary>
    <content type="html"><![CDATA[
<h2>叶随风(<em>LeafinWind</em>)</h2>
<p>我是『叶随风』，一条咸鱼。</p>
<!-- 
我叫『墨七』，一名非典型程序员。热爱编程，喜欢拥抱新技术，妄图改变世界，企图让世界因我而美好。

一名全站工程师，在多个开发领域都有着比较丰富的开发经验。

> 墨七 , mo7 , Mo7

## 关于爱好

写代码给我带来过很多快乐，也曾在我内心最悲伤的时候陪伴我走出阴影。

经常会突发奇想，喜欢自己设计构想，然后自己动手实现的那种成就感。写出来的东西被大家认可也会给我带来极大的满足感。

编码上头时，可以十几个小时不吃不睡依然精神；但也会一口气睡上十几个小时雷打不动(睡眠质量特别高，躺床上 10 分钟就没了意识，深度睡眠基本都在 4 小时往上)。

喜欢篮球，曾是校队成员；喜欢电影、游戏、美食、阅读和思考。喜欢创造，喜欢看着自己亲手建立的东西一点点完善。

喜欢玩原神、星际争霸、在 Steam 上体验各种大作。曾经的暴雪粉。

## 关于理想

愿世界和平，愿所有的种子都能开花结果，愿有情人终成眷属，愿好人一生平安。

但愿望终归只是愿望，我唯一能做的事情就是在目之所及之处做到最好，在自己能力范围之内发挥自己所长帮助更多的人。

## 关于本站

本站采用
[VuePress](https://v2.vuepress.vuejs.org) 搭建，
基于主题 [ThemeHope](https://theme-hope.vuejs.press) 由个人魔改而成。

关于更多信息可阅读 [关于本站](./关于本站.md)

在日常的工作和学习当中我积累了大量的经验、知识和技巧，他们被我用 md 记录了下来存储在 Github 的私人仓库之上。

![](./image/intro.png)

并且还有一些想法，想要表达的思想和观点等。我不太愿意将这些东西公布在各种公众平台之上，因为当我的知识变成了数据，那么这些数据的安全和版权应当由我自己负责，

写博客，并不仅仅只是为了表达，更是一种`记忆`和`修身养性`的方式，让自己浮躁的生活跟心情沉淀下来的一种手段。我希望过个七年八年的，再回首打开这个站点的时候，它能变成一种财富和寄托。

-->]]></content>
    <published>2024-07-25T08:47:38.000Z</published>
  </entry>
  <entry>
    <title type="text">关于本站</title>
    <id>https://blog.ysf.cc/about/website.html</id>
    <link href="https://blog.ysf.cc/about/website.html"/>
    <updated>2024-07-31T02:35:06.000Z</updated>
    <summary type="html"><![CDATA[
<p>我使用了<a href="https://theme-hope.vuejs.press/zh/" target="_blank" rel="noopener noreferrer">ThemeHope</a> 这款主题。使用了墨七(<a href="https://blog.mo7.cc/" target="_blank" rel="noopener noreferrer">https://blog.mo7.cc/</a>)大佬的模板，感恩💛！</p>
<!-- ## 前言

我基于 [ThemeHope](https://theme-hope.vuejs.press) 这款主题做了一些魔改改，包括样式以及功能。每一处修改均以插件的形式进行了封装，现在已经开源并发布。

Github 地址: <https://github.com/mo7cc/BlogSource>

> 注: 本站并非开源，但是我写了一个同步脚本，会定期将博客的源码同步至上述公开仓库中。通过上述仓库中的源码可以顺畅编译出本博客的全部公开内容。

> 本博客搭建的技术细节可以参考: [本博客搭建指南](../tutorial/vuepress-hope/)

### 顶栏和音乐播放器

这是顶部的一些下拉菜单，其中画板下拉菜单可以更改主题和全屏浏览。

我基于 [APlayer](https://aplayer.js.org) 开发了一款全局的音乐播放器。可以通过顶部导航栏右上角的 <MyIcon name="music" /> 按钮打开。音源来自于各大免费的音乐平台(侵删~)。 如果好的音乐推荐可以在评论区留言。

![顶部菜单 和 播放器 ](image/顶部导航栏.png)

还做了一个站点地图页面，可以直接访问本站已经发布的所有文章列表。

### 宽屏兼容

![宽屏兼容](image/宽屏兼容.png)

因为家里的屏幕是 21:9 的，但是主题的内容部分却依然是 窄窄的 一长条，空白地方留了很多。也不太好看，所以自己做了一个内容部分的宽屏兼容，适配更大的分辨率。

### 夜晚模式

尝试了很多很多的背景，调色，这一版的夜晚模式我非常满意。在白天模式和夜晚模式使用了不同的动态背景。第一版背景切换非常消耗性能。现在做了优化，现在切换非常流畅，内存占用非常低。

![夜晚模式](image/夜晚模式.png)

### 评论区介绍

评论区设置了发布频率限制，允许不登录匿名留言，支持 Markdown 语法，支持图片上传，支持预览和 Emoji 表情。

![评论区截图](./image/common.png)

> 建议使用 Github 登录。

## 缘起

我最初学编程的目的就是为了能够拥有一个属于自己的网站，我觉得那会很酷，仿佛自己的心声可以被全世界所听到。我觉得程序员很酷，因为我觉得每一个程序员都拥有足以改变世界的力量。

时代变化如此之快，还没等我自己的第一行代码上线运行，微博，知乎，简书等各大平台如同雨后春笋一样拔地而起，互联网时代就在我身边悄然而至，这些应用也在悄然的改变我们每一个人的思考和生活方式。时光荏苒，回头再望发现自己只不过是沧海一粟。

## 缘落

我们细数一下，在当前时代如果你想从零搭建一个自己可以完全操控的稳定的站点，需要哪些知识和技巧:

1. 通过域名商购买符合自己心意的域名。
2. 通过云计算服务商购买符合自己心意的服务器（此时你需要最基本的计算机基础知识，和 Linux 最基本的操作技巧以及处理操作系统常见问题的能力。）
3. 了解基本的 HTTP 原理。
4. 掌握 HTML、javascript、css 网页编辑语言，掌握常见的开发调试技巧。
5. 如果你想让数据流动起来，你需要掌握一门服务器编程语言和最基本的数据库操作使用方法。

> 查看[本站用到的相关技术](../favorite/links/document.md)，除此之外，网站的运营还涉及到 SEO ，流量推广，PWA 等等知识。如果你在中国大陆，想让自己的站点稳定的运行，还得了解基本的法律法规和管理条例以及备案技巧。

如果你想让它变得内容变得更加丰富，界面变得更加生动，访问速度更快，或者功能性更强。
你还得深入掌握更多更加专业的知识或者技巧。如果想要让站点能够与时俱进，得保证技术的更迭和软件的维护。随着功能越来越多，所需要的各种专业知识也将更多。

> 当然我们这里的讨论排除掉各种站点的速成框架以及集成化的方案，这种囫囵吞枣式的搭建方式都带有铜臭味。毕竟作为程序员，对技术还是需要一点点小资品位的。

大到淘宝、Facebook，小到个人站点，他们所需要的最基本的技术和配置都差不多，只是所需要的深浅不太一样。随着技术大牛们的努力和开源世界的慷慨，这些事情越来越容易。

## 需求

在最初，我是采用下面这种方式去记录自己的日常工作和学习的:

![这是图片](./image/weekly.jpg)

后来还用过飞书、Excel、各种 ToDo 软件等。还是觉得 `Vscode + Markdown` 的方式最好(吊打一切笔记软件)。方便阅读、方便修改、简单、兼容性好。一次编写可以很轻松的在各种格式下进行转换，属于文档当中的【基本单元】。不管是 Word、还是 Excel，如果没有特定的软件读取则无法访问，并且由于商业竞争，它们对其它软件的兼容性都很差强人意，格式转换时也会出现排版混乱等情况。但是 Markdown 则不同，它排版简单，使用方便，长什么样子完全取决于阅读器的主题，不同主题下可以可以拥有不同的观感，排版也不会混乱。包括我的个人资料，文件，文档，心得体会，和一些日常的小记录等我全都采用 md 去记录的。

[Markdown](https://markdown.com.cn) 中图片的处理会比较麻烦，传统的例如 word 等文件格式它会将图片一起打包到文件中，但是在 md 当中图片更像是文档的`依赖文件`，是游离于文字之外的东西，除非你使用网络图片。我研究了各种图床，但是都存在各种限制。免费的图床很多，但是想要使用方便、免费、访问速度，稳定安全等因素兼得，实在是太难了。于是我最终选择了自己开发一个图床服务。

## Hexo

[Hexo](https://hexo.io/) ，这是我在经过认真对比后采用的博客构建工具，主题丰富，生态完善，采用 md 编写内容，基于 node 和 npm ，上手简单快捷。但是用起来总有不舒服的点:

> 热更新速度慢，静态资源路径的识别无法跟编辑器很好的兼容，框架想要进行二次编码和修改只能使用最原始的 css 和 js 覆盖，想要集成 less 或者 ts 等现代前端工具需要自己编写和配置很多东西。

[Hexo 制作的博客](http://blog2.mo7.cc) \
[Hexo 博客项目源码](https://github.com/mo7Code/hexo-blog)

## VuePress

后来发现了 [VuePress](https://v2.vuepress.vuejs.org) ，在仔细体验后，大爱！ 因为是基于 vite ，所以可以做到在编写 md 时几乎无感的热更新速度，保存之后页面无刷新渲染，使用体验媲美 VSCode 的本地预览！

基于 Vue 渲染引擎，Vite 的编译和打包，TypeScript，Sass 支持，包括 Vue 组件等。博客的开发体验跟 WebApp 达成了一致，比 Hexo 高出了好几个档次。虽然生态尚不成熟，但是却无法挡住其锋芒。

缺点是主题和插件稀少，很多东西都得自己手动开发。

## vuepress-theme-hope

自己编写一款主题需要的细节和工作量是巨大的，我并不想投入那么多的时间和精力在这个上面。但是 VuePress 原本的默认主题又太过简陋。

在找寻许久后，我相中了 [ThemeHope](https://theme-hope.vuejs.press) 这款主题，它的作者是 VuePress 团队的成员，其更新速度和稳定性以及扩展性从基因层面就得到了保证。

于是基于 Hope 主题进行了一些细微的调教，自己写了一些功能模块，才有了本站当前的模样。

在这里感谢 [𝓜𝓻.𝓗𝓸𝓹𝓮](https://mrhope.site) 为我们带来这么棒的主题及其配套的插件。 -->]]></summary>
    <content type="html"><![CDATA[
<p>我使用了<a href="https://theme-hope.vuejs.press/zh/" target="_blank" rel="noopener noreferrer">ThemeHope</a> 这款主题。使用了墨七(<a href="https://blog.mo7.cc/" target="_blank" rel="noopener noreferrer">https://blog.mo7.cc/</a>)大佬的模板，感恩💛！</p>
<!-- ## 前言

我基于 [ThemeHope](https://theme-hope.vuejs.press) 这款主题做了一些魔改改，包括样式以及功能。每一处修改均以插件的形式进行了封装，现在已经开源并发布。

Github 地址: <https://github.com/mo7cc/BlogSource>

> 注: 本站并非开源，但是我写了一个同步脚本，会定期将博客的源码同步至上述公开仓库中。通过上述仓库中的源码可以顺畅编译出本博客的全部公开内容。

> 本博客搭建的技术细节可以参考: [本博客搭建指南](../tutorial/vuepress-hope/)

### 顶栏和音乐播放器

这是顶部的一些下拉菜单，其中画板下拉菜单可以更改主题和全屏浏览。

我基于 [APlayer](https://aplayer.js.org) 开发了一款全局的音乐播放器。可以通过顶部导航栏右上角的 <MyIcon name="music" /> 按钮打开。音源来自于各大免费的音乐平台(侵删~)。 如果好的音乐推荐可以在评论区留言。

![顶部菜单 和 播放器 ](image/顶部导航栏.png)

还做了一个站点地图页面，可以直接访问本站已经发布的所有文章列表。

### 宽屏兼容

![宽屏兼容](image/宽屏兼容.png)

因为家里的屏幕是 21:9 的，但是主题的内容部分却依然是 窄窄的 一长条，空白地方留了很多。也不太好看，所以自己做了一个内容部分的宽屏兼容，适配更大的分辨率。

### 夜晚模式

尝试了很多很多的背景，调色，这一版的夜晚模式我非常满意。在白天模式和夜晚模式使用了不同的动态背景。第一版背景切换非常消耗性能。现在做了优化，现在切换非常流畅，内存占用非常低。

![夜晚模式](image/夜晚模式.png)

### 评论区介绍

评论区设置了发布频率限制，允许不登录匿名留言，支持 Markdown 语法，支持图片上传，支持预览和 Emoji 表情。

![评论区截图](./image/common.png)

> 建议使用 Github 登录。

## 缘起

我最初学编程的目的就是为了能够拥有一个属于自己的网站，我觉得那会很酷，仿佛自己的心声可以被全世界所听到。我觉得程序员很酷，因为我觉得每一个程序员都拥有足以改变世界的力量。

时代变化如此之快，还没等我自己的第一行代码上线运行，微博，知乎，简书等各大平台如同雨后春笋一样拔地而起，互联网时代就在我身边悄然而至，这些应用也在悄然的改变我们每一个人的思考和生活方式。时光荏苒，回头再望发现自己只不过是沧海一粟。

## 缘落

我们细数一下，在当前时代如果你想从零搭建一个自己可以完全操控的稳定的站点，需要哪些知识和技巧:

1. 通过域名商购买符合自己心意的域名。
2. 通过云计算服务商购买符合自己心意的服务器（此时你需要最基本的计算机基础知识，和 Linux 最基本的操作技巧以及处理操作系统常见问题的能力。）
3. 了解基本的 HTTP 原理。
4. 掌握 HTML、javascript、css 网页编辑语言，掌握常见的开发调试技巧。
5. 如果你想让数据流动起来，你需要掌握一门服务器编程语言和最基本的数据库操作使用方法。

> 查看[本站用到的相关技术](../favorite/links/document.md)，除此之外，网站的运营还涉及到 SEO ，流量推广，PWA 等等知识。如果你在中国大陆，想让自己的站点稳定的运行，还得了解基本的法律法规和管理条例以及备案技巧。

如果你想让它变得内容变得更加丰富，界面变得更加生动，访问速度更快，或者功能性更强。
你还得深入掌握更多更加专业的知识或者技巧。如果想要让站点能够与时俱进，得保证技术的更迭和软件的维护。随着功能越来越多，所需要的各种专业知识也将更多。

> 当然我们这里的讨论排除掉各种站点的速成框架以及集成化的方案，这种囫囵吞枣式的搭建方式都带有铜臭味。毕竟作为程序员，对技术还是需要一点点小资品位的。

大到淘宝、Facebook，小到个人站点，他们所需要的最基本的技术和配置都差不多，只是所需要的深浅不太一样。随着技术大牛们的努力和开源世界的慷慨，这些事情越来越容易。

## 需求

在最初，我是采用下面这种方式去记录自己的日常工作和学习的:

![这是图片](./image/weekly.jpg)

后来还用过飞书、Excel、各种 ToDo 软件等。还是觉得 `Vscode + Markdown` 的方式最好(吊打一切笔记软件)。方便阅读、方便修改、简单、兼容性好。一次编写可以很轻松的在各种格式下进行转换，属于文档当中的【基本单元】。不管是 Word、还是 Excel，如果没有特定的软件读取则无法访问，并且由于商业竞争，它们对其它软件的兼容性都很差强人意，格式转换时也会出现排版混乱等情况。但是 Markdown 则不同，它排版简单，使用方便，长什么样子完全取决于阅读器的主题，不同主题下可以可以拥有不同的观感，排版也不会混乱。包括我的个人资料，文件，文档，心得体会，和一些日常的小记录等我全都采用 md 去记录的。

[Markdown](https://markdown.com.cn) 中图片的处理会比较麻烦，传统的例如 word 等文件格式它会将图片一起打包到文件中，但是在 md 当中图片更像是文档的`依赖文件`，是游离于文字之外的东西，除非你使用网络图片。我研究了各种图床，但是都存在各种限制。免费的图床很多，但是想要使用方便、免费、访问速度，稳定安全等因素兼得，实在是太难了。于是我最终选择了自己开发一个图床服务。

## Hexo

[Hexo](https://hexo.io/) ，这是我在经过认真对比后采用的博客构建工具，主题丰富，生态完善，采用 md 编写内容，基于 node 和 npm ，上手简单快捷。但是用起来总有不舒服的点:

> 热更新速度慢，静态资源路径的识别无法跟编辑器很好的兼容，框架想要进行二次编码和修改只能使用最原始的 css 和 js 覆盖，想要集成 less 或者 ts 等现代前端工具需要自己编写和配置很多东西。

[Hexo 制作的博客](http://blog2.mo7.cc) \
[Hexo 博客项目源码](https://github.com/mo7Code/hexo-blog)

## VuePress

后来发现了 [VuePress](https://v2.vuepress.vuejs.org) ，在仔细体验后，大爱！ 因为是基于 vite ，所以可以做到在编写 md 时几乎无感的热更新速度，保存之后页面无刷新渲染，使用体验媲美 VSCode 的本地预览！

基于 Vue 渲染引擎，Vite 的编译和打包，TypeScript，Sass 支持，包括 Vue 组件等。博客的开发体验跟 WebApp 达成了一致，比 Hexo 高出了好几个档次。虽然生态尚不成熟，但是却无法挡住其锋芒。

缺点是主题和插件稀少，很多东西都得自己手动开发。

## vuepress-theme-hope

自己编写一款主题需要的细节和工作量是巨大的，我并不想投入那么多的时间和精力在这个上面。但是 VuePress 原本的默认主题又太过简陋。

在找寻许久后，我相中了 [ThemeHope](https://theme-hope.vuejs.press) 这款主题，它的作者是 VuePress 团队的成员，其更新速度和稳定性以及扩展性从基因层面就得到了保证。

于是基于 Hope 主题进行了一些细微的调教，自己写了一些功能模块，才有了本站当前的模样。

在这里感谢 [𝓜𝓻.𝓗𝓸𝓹𝓮](https://mrhope.site) 为我们带来这么棒的主题及其配套的插件。 -->
]]></content>
    <published>2024-07-25T08:47:38.000Z</published>
  </entry>
  <entry>
    <title type="text">留言板</title>
    <id>https://blog.ysf.cc/about/guestbook.html</id>
    <link href="https://blog.ysf.cc/about/guestbook.html"/>
    <updated>2024-08-02T09:08:31.000Z</updated>
    <summary type="html"><![CDATA[
<div class="hint-container info">
<p class="hint-container-title">™</p>
<div style="text-align:center">
<p>有什麽想説的？</p>
<p>有什麽想問的？</p>
<p>有什麽想吐槽的？</p>
<p>可以在下面留言...</p>
</div>
<div style="text-align:right">
<!-- [@墨七](https://mo7.cc)。 -->
<p><a href="https://yesuifeng.cc" target="_blank" rel="noopener noreferrer">@叶随风</a>。</p>
</div>
</div>]]></summary>
    <content type="html"><![CDATA[
<div class="hint-container info">
<p class="hint-container-title">™</p>
<div style="text-align:center">
<p>有什麽想説的？</p>
<p>有什麽想問的？</p>
<p>有什麽想吐槽的？</p>
<p>可以在下面留言...</p>
</div>
<div style="text-align:right">
<!-- [@墨七](https://mo7.cc)。 -->
<p><a href="https://yesuifeng.cc" target="_blank" rel="noopener noreferrer">@叶随风</a>。</p>
</div>
</div>
]]></content>
    <published>2024-07-25T08:47:38.000Z</published>
  </entry>
  <entry>
    <title type="text">站点地图</title>
    <id>https://blog.ysf.cc/posts/catalog.html</id>
    <link href="https://blog.ysf.cc/posts/catalog.html"/>
    <updated>2024-08-22T05:51:13.000Z</updated>
    <summary type="html"><![CDATA[
<h2>本站全部文章索引</h2>
]]></summary>
    <content type="html"><![CDATA[
<h2>本站全部文章索引</h2>
]]></content>
    <category term="博客"/>
    <published>2024-07-25T08:47:38.000Z</published>
  </entry>
  <entry>
    <title type="text">友链</title>
    <id>https://blog.ysf.cc/favorite/links/friend.html</id>
    <link href="https://blog.ysf.cc/favorite/links/friend.html"/>
    <updated>2025-01-22T05:30:50.000Z</updated>
    <summary type="html"><![CDATA[
]]></summary>
    <content type="html"><![CDATA[
]]></content>
    <published>2024-07-25T08:47:38.000Z</published>
  </entry>
  <entry>
    <title type="text">FTP服务器连接</title>
    <id>https://blog.ysf.cc/sap/abap/ftp.html</id>
    <link href="https://blog.ysf.cc/sap/abap/ftp.html"/>
    <updated>2024-10-25T08:50:30.000Z</updated>
    <summary type="html"><![CDATA[
<div class="hint-container tip">
<p class="hint-container-title">提示</p>
<p>FTP服务器</p>
</div>
<!-- 摘要截止标签 -->
]]></summary>
    <content type="html"><![CDATA[
<div class="hint-container tip">
<p class="hint-container-title">提示</p>
<p>FTP服务器</p>
</div>
<!-- 摘要截止标签 -->
<!-- more -->
<p>目标:已有FTP服务器IP和账号密码，通过sap与服务器连接，下载对应的文件并下载至PC并在浏览器显示内容。</p>
<ul>
<li>连接服务器还可以用webservice方式。</li>
<li>pdf档案可以转换成字符串传输到其它系统(ps:没试过)<br>
xstring字节流？</li>
<li>sm30维护SAPFTP_SERVERS_V配置表</li>
<li>连接ftp服务器可能还需要VPN，测试和正式不一样(寻求basis帮忙配置)🎈。</li>
<li>当FTP服务器方面没有对应文件时，SAP进行FTP_SERVER_TO_R3函数从FTP将文件读取到内表时，如果FTP没有此目录文件会报错-&gt;FTP 子命令: 服务器报表错误<br>
经排查不是用户权限和网关防火墙等原因</li>
<li>SDM是目录<br>
是你ftp账号的根目录<br>
执行此命令nlist SDM/2024-09-15，如果没有这个文件会报错226 transfer done(but failed to open directory)<br>
</li>
<li>踩坑测试的目录和正式的目录不一样<br>
SDM/2024-09-15/20240914_20701010253_4344832_2.pdf正式<br>
/SDM/2023-05-07/20230506_20701010253_3795391_2.pdf测试<br>
</li>
</ul>
<h2>代码</h2>
<div class="language-abap line-numbers-mode" data-highlighter="shiki" data-ext="abap" data-title="abap" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">   CASE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_UCOMM.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    WHEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '&amp;IC1'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      CASE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> RS_SELFIELD-FIELDNAME.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        WHEN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'ZPDF'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MANDT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '800'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*            LV_USER = 'yes'.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            LV_USER </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '******'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            LV_PWD  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '******'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            LV_HSOT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '******'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"最新的正式</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          ELSEIF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MANDT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '300'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            LV_USER </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '******'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            LV_PWD  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '******'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            LV_HSOT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '******'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">"测试</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          LV_HSOT = '******'."之前的正式</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">          LV_SLEN  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> STRLEN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">( LV_PWD ).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          READ TABLE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GT_DATA </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_DATA</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> RS_SELFIELD-TABINDEX.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> GS_DATA-ZPDF </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> NOT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INITIAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            LV_COMMAND </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  GS_DATA-ZPDF.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'HTTP_SCRAMBLE'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                SOURCE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_PWD</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                SOURCELEN   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_SLEN</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                KEY</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         = KEY</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                DESTINATION</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_PWD.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">***打开 FTP 服务器</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'FTP_CONNECT'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                USER</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_USER</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                PASSWORD        </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_PWD</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                HOST            </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_HSOT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                RFC_DESTINATION </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'SAPFTPA'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                HANDLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> EV_HANDLE</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                NOT_CONNECTED   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">  SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> NE</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              MESSAGE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'FTP连接失败，请联系IT部门'</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'E'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> .</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">***获取FTP 指定目录文件名称</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            LV_SLEN </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> STRLEN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">( LV_COMMAND ).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'FTP_COMMAND'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                HANDLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> EV_HANDLE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                COMMAND       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'set passive on'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              TABLES</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                DATA</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_RESULT</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                COMMAND_ERROR </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                TCPIP_ERROR   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CLEAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_RESULT[].</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CONCATENATE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'nlist'</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '/SDM/2023-06-15'</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">SEPARATED</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> BY</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> SPACE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'FTP_COMMAND'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                HANDLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> EV_HANDLE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                COMMAND       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              TABLES</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                DATA</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_RESULT</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                TCPIP_ERROR   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                COMMAND_ERROR </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                DATA_ERROR    </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CLEAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LT_RESULT[].</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CLEAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_STATUS.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'WS_QUERY'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                FILENAME       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '/SDM'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                QUERY</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'DE'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                RETURN</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_STATUS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                INV_QUERY      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                NO_BATCH       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                FRONTEND_ERROR </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_STATUS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'GUI_CREATE_DIRECTORY'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                  DIRNAME </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '/SDM'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                  FAILED</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                  OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CLEAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_STATUS.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            SELECT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> SINGLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> *</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> @</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">DATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">LS_002</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> ZFIR002 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> BELNR  </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> @GS_DATA-BELNR.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            IF</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">SUBRC</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              LS_002-BUDAT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_002-BUDAT </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              P_FILENAME </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '/SDM/'</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &amp;&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_002-BUDAT+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">&amp;&amp;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '-'</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &amp;&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LS_002-BUDAT+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">&amp;&amp;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '-'</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                             LS_002-BUDAT+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'WS_QUERY'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                FILENAME       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_FILENAME</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                QUERY</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'DE'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                RETURN</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_STATUS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                INV_QUERY      </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                NO_BATCH       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                FRONTEND_ERROR </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 3</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">         =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_STATUS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              P_DIRNAME </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_FILENAME.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'GUI_CREATE_DIRECTORY'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                  DIRNAME </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_DIRNAME</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                  FAILED</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                  OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">  =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CLEAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> P_STATUS.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> NOT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INITIAL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> AND</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MANDT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '800'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">..</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              LV_COMMAND </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">98</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">*          lv_command = '/SDM/2023-06-15/20230606_20701010006_3844645_2.pdf'.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CLEAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> BLOB[].</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'FTP_SERVER_TO_R3'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                HANDLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> EV_HANDLE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                FNAME       </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              IMPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                BLOB_LENGTH </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> BLOB_LENGTH</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              TABLES</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                BLOB        </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> BLOB.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            IF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">IS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> NOT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> INITIAL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> AND</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B"> SY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B">MANDT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '800'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">..</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">              LV_COMMAND </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '/'</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> &amp;&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">            LV_COMMAND2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'GUI_DOWNLOAD'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                FILENAME </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                FILETYPE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'BIN'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              TABLES</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">                DATA_TAB </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> BLOB.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'FTP_DISCONNECT'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                HANDLE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> EV_HANDLE.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> FUNCTION</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'RFC_CONNECTION_CLOSE'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                DESTINATION</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'SAPFTP'</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXCEPTIONS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                OTHERS</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">            CALL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> METHOD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> CL_GUI_FRONTEND_SERVICES=&gt;EXECUTE</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">              EXPORTING</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">                APPLICATION</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> LV_COMMAND2.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">          ENDIF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">        WHEN</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD"> OTHERS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">      ENDCASE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">.</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!-- <Catalog base='/' hideHeading/> -->
]]></content>
    <category term="SAP"/>
    <published>2024-07-24T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">搜索帮助</title>
    <id>https://blog.ysf.cc/sap/abap/shelp.html</id>
    <link href="https://blog.ysf.cc/sap/abap/shelp.html"/>
    <updated>2024-08-22T08:19:12.000Z</updated>
    <summary type="html"><![CDATA[
<p>123</p>
<!-- <Catalog base='/' hideHeading/> -->
]]></summary>
    <content type="html"><![CDATA[
<p>123</p>
<!-- <Catalog base='/' hideHeading/> -->
]]></content>
    <category term="SAP"/>
    <published>2024-07-25T08:47:38.000Z</published>
  </entry>
  <entry>
    <title type="text">查找数据存在的表</title>
    <id>https://blog.ysf.cc/sap/abap/table.html</id>
    <link href="https://blog.ysf.cc/sap/abap/table.html"/>
    <updated>2024-08-27T00:51:56.000Z</updated>
    <summary type="html"><![CDATA[
<p>这里记录一下我已知的怎么查找前台字段存在后台的那个数据库表里。</p>
]]></summary>
    <content type="html"><![CDATA[
<p>这里记录一下我已知的怎么查找前台字段存在后台的那个数据库表里。</p>
<!-- more -->
<!-- <Catalog base='/' hideHeading/> -->
<h2>F1直接查看表</h2>
<p>选中前台字段，按F1→技术信息，表类别是透明表的数据就直接存在那里。<br>
</p>
<h2>使用ST05来追踪表</h2>
<p>如果表类别是结构的，你可以修改一下他</p>
<ol>
<li>ST05 Activate Trace</li>
<li>修改前台数据</li>
<li>ST05 Deactivate Trace</li>
<li>Dispaly Trace查看该字段存在于哪个表(可能操作了多个表自己判断一下)<br>
<br>
</li>
</ol>
<h2>根据数据元素查找</h2>
<p>有时候根据第一种方法找出的表名是结构类型的，这时可以用字段对应的元素继续查找。<br>
<br>
有可能没有，有可能有并且需要自己判断下是哪个表</p>
<h2>通过SM12查看</h2>
<p>对于可编辑状态的事务，进入到屏幕之后系统会锁定相关的后台表，这样通过SM12就可以查看到该事务所对应的一些表了。但此方法不能将所有的表都罗列出来，例如表QPMT<br>
</p>
<h2>通过字段对应的搜索帮助进行查找</h2>
<h2>根据经验查找</h2>
<p>比如你在前台me23n看到的字段，一般可以根据经验在EKKO和EKPO表中。</p>
<h2>参考资料</h2>
<p><a href="https://zhuanlan.zhihu.com/p/652011447" target="_blank" rel="noopener noreferrer">ST05查找并判断SAP前台屏幕表字段</a><br>
<a href="https://blog.csdn.net/aa11437/article/details/122740266?spm=1001.2014.3001.5502" target="_blank" rel="noopener noreferrer">SAP中根据字段查找对应表的方法-悲秋廿四</a></p>
]]></content>
    <category term="SAP"/>
    <published>2024-08-09T00:00:00.000Z</published>
  </entry>
  <entry>
    <title type="text">Bapi</title>
    <id>https://blog.ysf.cc/sap/abap/bapi.html</id>
    <link href="https://blog.ysf.cc/sap/abap/bapi.html"/>
    <updated>2024-08-13T06:10:10.000Z</updated>
    <summary type="html"><![CDATA[
<p>123</p>
<!-- <Catalog base='/' hideHeading/> -->
]]></summary>
    <content type="html"><![CDATA[
<p>123</p>
<!-- <Catalog base='/' hideHeading/> -->
]]></content>
    <category term="SAP"/>
    <published>2024-07-25T08:47:38.000Z</published>
  </entry>
</feed>